"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[747],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>k});var a=t(7294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,l=function(e,n){if(null==e)return{};var t,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var p=a.createContext({}),s=function(e){var n=a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=s(e.components);return a.createElement(p.Provider,{value:n},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},c=a.forwardRef((function(e,n){var t=e.components,l=e.mdxType,r=e.originalType,p=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=s(t),c=l,k=d["".concat(p,".").concat(c)]||d[c]||m[c]||r;return t?a.createElement(k,o(o({ref:n},u),{},{components:t})):a.createElement(k,o({ref:n},u))}));function k(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var r=t.length,o=new Array(r);o[0]=c;var i={};for(var p in n)hasOwnProperty.call(n,p)&&(i[p]=n[p]);i.originalType=e,i[d]="string"==typeof e?e:l,o[1]=i;for(var s=2;s<r;s++)o[s]=t[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}c.displayName="MDXCreateElement"},3529:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>o,default:()=>m,frontMatter:()=>r,metadata:()=>i,toc:()=>s});var a=t(7462),l=(t(7294),t(3905));const r={description:"JavaScript \u9ad8\u7ea7\u7a0b\u5e8f\u8bbe\u8ba1(\u7b2c\u56db\u7248) \u4e8c\u5341\u5230\u9644\u5f55\u7684\u9605\u8bfb\u7b14\u8bb0"},o="JavaScript-advanced",i={unversionedId:"JavaScript/JavaScript-advanced",id:"JavaScript/JavaScript-advanced",title:"JavaScript-advanced",description:"JavaScript \u9ad8\u7ea7\u7a0b\u5e8f\u8bbe\u8ba1(\u7b2c\u56db\u7248) \u4e8c\u5341\u5230\u9644\u5f55\u7684\u9605\u8bfb\u7b14\u8bb0",source:"@site/docs/JavaScript/JavaScript-advanced.md",sourceDirName:"JavaScript",slug:"/JavaScript/JavaScript-advanced",permalink:"/Walk-on/docs/JavaScript/JavaScript-advanced",draft:!1,editUrl:"https://github.com/LinZhifana/Walk-on/docs/JavaScript/JavaScript-advanced.md",tags:[],version:"current",frontMatter:{description:"JavaScript \u9ad8\u7ea7\u7a0b\u5e8f\u8bbe\u8ba1(\u7b2c\u56db\u7248) \u4e8c\u5341\u5230\u9644\u5f55\u7684\u9605\u8bfb\u7b14\u8bb0"},sidebar:"tutorialSidebar",previous:{title:"JavaScript-basic",permalink:"/Walk-on/docs/JavaScript/JavaScript-basic"},next:{title:"React",permalink:"/Walk-on/docs/category/react"}},p={},s=[{value:"JavaScript API",id:"javascript-api",level:2},{value:"SharedArrayBuffer",id:"sharedarraybuffer",level:3},{value:"Atomics",id:"atomics",level:3},{value:"\u8de8\u4e0a\u4e0b\u6587\u6d88\u606f XDM\uff08cross-document messaging\uff09",id:"\u8de8\u4e0a\u4e0b\u6587\u6d88\u606f-xdmcross-document-messaging",level:3},{value:"Encoding API",id:"encoding-api",level:3},{value:"File API",id:"file-api",level:3},{value:"FileReader",id:"filereader",level:4},{value:"Blob",id:"blob",level:4},{value:"Notifications API",id:"notifications-api",level:3},{value:"\u901a\u77e5\u751f\u547d\u5468\u671f\u56de\u8c03",id:"\u901a\u77e5\u751f\u547d\u5468\u671f\u56de\u8c03",level:4},{value:"Page Visibility API",id:"page-visibility-api",level:3},{value:"Stream API",id:"stream-api",level:3},{value:"\u6d41",id:"\u6d41",level:4},{value:"\u5757\u3001\u5185\u90e8\u961f\u5217\u548c\u53cd\u538b",id:"\u5757\u5185\u90e8\u961f\u5217\u548c\u53cd\u538b",level:4},{value:"\u7ba1\u9053\u8fde\u63a5\u6d41",id:"\u7ba1\u9053\u8fde\u63a5\u6d41",level:4},{value:"\u8ba1\u65f6 API",id:"\u8ba1\u65f6-api",level:3},{value:"Web Components",id:"web-components",level:3},{value:"HTML \u6a21\u7248",id:"html-\u6a21\u7248",level:4},{value:"Shadow DOM",id:"shadow-dom",level:4},{value:"slot",id:"slot",level:4},{value:"\u81ea\u5b9a\u4e49\u5143\u7d20",id:"\u81ea\u5b9a\u4e49\u5143\u7d20",level:4},{value:"Web Cryptography API",id:"web-cryptography-api",level:3},{value:"JSON",id:"json",level:2},{value:"\u7f51\u7edc\u8bf7\u6c42\u4e0e\u8fdc\u7a0b\u8d44\u6e90",id:"\u7f51\u7edc\u8bf7\u6c42\u4e0e\u8fdc\u7a0b\u8d44\u6e90",level:2},{value:"XMLHttpRequest",id:"xmlhttprequest",level:3},{value:"HTTP \u5934\u90e8",id:"http-\u5934\u90e8",level:4},{value:"GET POST",id:"get-post",level:4},{value:"FormData \u7c7b\u578b",id:"formdata-\u7c7b\u578b",level:4},{value:"\u8d85\u65f6",id:"\u8d85\u65f6",level:4},{value:"overrideMimeType()\u65b9\u6cd5",id:"overridemimetype\u65b9\u6cd5",level:4},{value:"\u8fdb\u5ea6\u4e8b\u4ef6",id:"\u8fdb\u5ea6\u4e8b\u4ef6",level:3},{value:"progress \u4e8b\u4ef6",id:"progress-\u4e8b\u4ef6",level:4},{value:"CORS",id:"cors",level:3},{value:"\u9884\u68c0\u8bf7\u6c42 preflight request",id:"\u9884\u68c0\u8bf7\u6c42-preflight-request",level:4},{value:"\u51ed\u636e\u8bf7\u6c42",id:"\u51ed\u636e\u8bf7\u6c42",level:4},{value:"\u66ff\u4ee3\u6027\u8de8\u6e90\u6280\u672f",id:"\u66ff\u4ee3\u6027\u8de8\u6e90\u6280\u672f",level:3},{value:"\u56fe\u7247\u63a2\u6d4b",id:"\u56fe\u7247\u63a2\u6d4b",level:4},{value:"JSONP (JSON with padding)",id:"jsonp-json-with-padding",level:4},{value:"Fetch API",id:"fetch-api",level:3},{value:"Headers",id:"headers",level:4},{value:"Request",id:"request",level:4},{value:"Response",id:"response",level:4},{value:"Request\u3001Response \u53ca Body \u6df7\u5165",id:"requestresponse-\u53ca-body-\u6df7\u5165",level:4},{value:"Beacon API",id:"beacon-api",level:3},{value:"Web Socket",id:"web-socket",level:3},{value:"\u53d1\u9001\u548c\u63a5\u53d7\u6570\u636e",id:"\u53d1\u9001\u548c\u63a5\u53d7\u6570\u636e",level:4},{value:"\u5ba2\u6237\u7aef\u5b58\u50a8",id:"\u5ba2\u6237\u7aef\u5b58\u50a8",level:2},{value:"Cookie",id:"cookie",level:3},{value:"\u5b50 Cookie",id:"\u5b50-cookie",level:4},{value:"Storage",id:"storage",level:3},{value:"IndexedDB",id:"indexeddb",level:3},{value:"\u6a21\u5757",id:"\u6a21\u5757",level:2},{value:"\u5f02\u6b65\u4f9d\u8d56",id:"\u5f02\u6b65\u4f9d\u8d56",level:3},{value:"\u52a8\u6001\u4f9d\u8d56",id:"\u52a8\u6001\u4f9d\u8d56",level:3},{value:"\u9759\u6001\u5206\u6790",id:"\u9759\u6001\u5206\u6790",level:3},{value:"\u5faa\u73af\u4f9d\u8d56",id:"\u5faa\u73af\u4f9d\u8d56",level:3},{value:"CommonJS",id:"commonjs",level:3},{value:"ES6 \u6a21\u5757",id:"es6-\u6a21\u5757",level:3},{value:"\u5de5\u4f5c\u8005\u6a21\u5757",id:"\u5de5\u4f5c\u8005\u6a21\u5757",level:4},{value:"\u5411\u540e\u517c\u5bb9",id:"\u5411\u540e\u517c\u5bb9",level:4},{value:"\u5de5\u4f5c\u8005\u7ebf\u7a0b",id:"\u5de5\u4f5c\u8005\u7ebf\u7a0b",level:2},{value:"WorkerGlobalScope",id:"workerglobalscope",level:3},{value:"\u4e13\u7528\u5de5\u4f5c\u8005 Web Worker",id:"\u4e13\u7528\u5de5\u4f5c\u8005-web-worker",level:3},{value:"\u5171\u4eab\u5de5\u4f5c\u8005",id:"\u5171\u4eab\u5de5\u4f5c\u8005",level:3},{value:"\u670d\u52a1\u5de5\u4f5c\u8005",id:"\u670d\u52a1\u5de5\u4f5c\u8005",level:3},{value:"Tips",id:"tips",level:2}],u={toc:s},d="wrapper";function m(e){let{components:n,...t}=e;return(0,l.kt)(d,(0,a.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"javascript-advanced"},"JavaScript-advanced"),(0,l.kt)("h2",{id:"javascript-api"},"JavaScript API"),(0,l.kt)("h3",{id:"sharedarraybuffer"},"SharedArrayBuffer"),(0,l.kt)("p",null,"SharedArrayBuffer \u53ef\u4ee5\u88ab\u4efb\u610f\u591a\u4e2a\u6267\u884c\u4e0a\u4e0b\u6587\u540c\u65f6\u4f7f\u7528(\u5e76\u53d1)"),(0,l.kt)("p",null,"// todo"),(0,l.kt)("h3",{id:"atomics"},"Atomics"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"const buffer = new SharedArrayBuffer(16)\nconst uint8 = new Uint8Array(buffer)\nunit8[0] = 7\n// 7+2=9\n// \u8fd4\u56de\u65e7\u503c 7\nAtomics.add(unit8, 0, 2)\n// 7-2=5\n// \u8fd4\u56de\u65e7\u503c 7\nAtomics.sub(unit8, 0, 2)\n// 0011 & 0010 = 0010\n// \u8fd4\u56de\u65e7\u503c 7\nAtomics.and(uint8, 0, 0b0010)\n// 0011 | 0010 = 0111\n// \u8fd4\u56de\u65e7\u503c 7\nAtomics.or(uint8, 0, 2)\n// 7 (0111) XOR 2 (0010) = 5 (0101)\n// \u8fd4\u56de\u65e7\u503c 7\nAtomics.xor(uint8, 0, 2)\n\n// 1. \u6240\u6709\u539f\u5b50\u6307\u4ee4\u76f8\u4e92\u4e4b\u95f4\u7684\u987a\u5e8f\u6c38\u8fdc\u4e0d\u4f1a\u91cd\u6392\n// 2. \u4f4d\u4e8e\u539f\u5b50\u8bfb/\u5199\u4e4b\u524d\u7684\u6240\u6709\u6307\u4ee4\u4f1a\u5728\u539f\u5b50\u8bfb/\u5199\u53d1\u751f\u524d\u5b8c\u6210,\n//    \u800c\u4f4d\u4e8e\u539f\u5b50\u8bfb/\u5199\u4e4b\u540e\u7684\u6240\u6709\u6307\u4ee4\u4f1a\u5728\u539f\u5b50\u8bfb/\u5199\u5b8c\u6210\u540e\u624d\u4f1a\u5f00\u59cb\n// \u539f\u5b50\u8bfb\nAtomics.load(uint8, 0)\n// \u539f\u5b50\u5199\nAtomics.store(uint8, 0, 2)\n")),(0,l.kt)("p",null,"// todo"),(0,l.kt)("h3",{id:"\u8de8\u4e0a\u4e0b\u6587\u6d88\u606f-xdmcross-document-messaging"},"\u8de8\u4e0a\u4e0b\u6587\u6d88\u606f XDM\uff08cross-document messaging\uff09"),(0,l.kt)("p",null,"\u8de8\u6587\u6863\u6d88\u606f(XDM), \u662f\u4e00\u79cd\u5728\u4e0d\u540c\u6267\u884c\u4e0a\u4e0b\u6587\uff08\u5982\u4e0d\u540c\u5de5\u4f5c\u7ebf\u7a0b\u6216\u4e0d\u540c\u6e90\u7684\u9875\u9762\uff09\u95f4\u4f20\u9012\u4fe1\u606f\u7684\u80fd\u529b"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"postMessage()"),"\u6d88\u606f\u3001\u8868\u793a\u76ee\u6807\u63a5\u6536\u6e90\u7684\u5b57\u7b26\u4e32\u548c\u53ef\u9009\u7684\u53ef\u4f20\u8f93\u5bf9\u8c61\u7684\u6570\u7ec4\uff08\u53ea\u4e0e\u5de5\u4f5c\u7ebf\u7a0b\u76f8\u5173\uff09"),(0,l.kt)("p",null,"window \u5bf9\u8c61\u4e0a\u89e6\u53d1 message \u4e8b\u4ef6(onMessage), event \u5305\u542b\u4e0b\u9762\u4e09\u4e2a\u4fe1\u606f:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"data \u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u53c2\u6570\u4f20\u9012\u7ed9 postMessage() \u7684\u5b57\u7b26\u4e32\u6570\u636e"),(0,l.kt)("li",{parentName:"ul"},'origin \u53d1\u9001\u6d88\u606f\u7684\u6587\u6863\u6e90, \u4f8b\u5982 "',(0,l.kt)("a",{parentName:"li",href:"http://www.wrox.com%22"},'http://www.wrox.com"')),(0,l.kt)("li",{parentName:"ul"},"source \u53d1\u9001\u6d88\u606f\u7684\u6587\u6863\u4e2d window \u5bf9\u8c61\u7684\u4ee3\u7406\u3002\u8fd9\u4e2a\u4ee3\u7406\u5bf9\u8c61\u4e3b\u8981\u7528\u4e8e\u5728\u53d1\u9001\u4e0a\u4e00\u6761\u6d88\u606f\u7684\u7a97\u53e3\u4e2d\u6267\u884c postMessage() \u65b9\u6cd5\u3002\u5982\u679c\u53d1\u9001\u7a97\u53e3\u6709\u76f8\u540c\u7684\u6e90, \u90a3\u4e48\u8fd9\u4e2a\u5bf9\u8c61\u5e94\u8be5\u5c31\u662f window \u5bf9\u8c61")),(0,l.kt)("h3",{id:"encoding-api"},"Encoding API"),(0,l.kt)("p",null,"Encoding API \u4e3b\u8981\u7528\u4e8e\u5b9e\u73b0\u5b57\u7b26\u4e32\u4e0e\u5b9a\u578b\u6570\u7ec4\u4e4b\u95f4\u7684\u8f6c\u6362\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"// \u6279\u91cf\u7f16\u7801 \u89e3\u7801\nconst textEncoder = new TextEncoder()\nconst encodedText = TextEncoder.encode(decodedText)\n\nconst textDecoder = new TextDecoder()\nconst decodedText = TextDecoder.decode(encodedText)\n\n// \u6d41\u7f16\u7801 \u89e3\u7801\n// todo\n")),(0,l.kt)("h3",{id:"file-api"},"File API"),(0,l.kt)("p",null,"\u524d\u7aef\u5904\u7406\u6587\u4ef6"),(0,l.kt)("p",null,"File \u5bf9\u8c61:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"name \u6587\u4ef6\u540d"),(0,l.kt)("li",{parentName:"ul"},"size \u4ee5\u5b57\u8282\u8ba1\u7684\u6587\u4ef6\u5927\u5c0f"),(0,l.kt)("li",{parentName:"ul"},"type \u6587\u4ef6 MIME \u7c7b\u578b(\u6587\u4ef6\u7c7b\u578b)")),(0,l.kt)("h4",{id:"filereader"},"FileReader"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"readAsText(file, encoding)"),(0,l.kt)("li",{parentName:"ul"},"readAsDataURL(file)"),(0,l.kt)("li",{parentName:"ul"},"readAsBinaryString(file)"),(0,l.kt)("li",{parentName:"ul"},"readAsArrayBuffer(file)")),(0,l.kt)("p",null,"\u4e8b\u4ef6: progress error load abort"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"const fileInput = document.getElementById('input')\nfileInput.addEventListener('change', (event) => {\n  const selectedFile = event.target.files[0]\n\n  const reader = new FileReader()\n\n  reader.onload = (e) => {\n    const data = e.target.result\n  }\n\n  reader.readerAsText(selectedFile)\n})\n")),(0,l.kt)("p",null,"\u540c\u6b65\u7248\u672c FileReaderSync"),(0,l.kt)("h4",{id:"blob"},"Blob"),(0,l.kt)("p",null,"blob \u8868\u793a\u4e8c\u8fdb\u5236\u5927\u5bf9\u8c61\uff08binary large object\uff09"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'console.log(new Blob([\'foo\']))\n// Blob {size: 3, type: ""}\nconsole.log(new Blob([\'{"a": "b"}\'], { type: \'application/json\' }))\n// {size: 10, type: "application/json"}\n')),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"var blob = instanceOfBlob.slice([start [, end [, contentType]]]};")),(0,l.kt)("p",null,"\u5bf9\u8c61 URL \u6709\u65f6\u5019\u4e5f\u79f0\u4f5c Blob URL, \u662f\u6307\u5f15\u7528\u5b58\u50a8\u5728 File \u6216 Blob \u4e2d\u6570\u636e\u7684 URL\u3002\u5bf9\u8c61 URL \u7684\u4f18\u70b9\u662f\u4e0d\u7528\u628a\u6587\u4ef6\u5185\u5bb9\u8bfb\u53d6\u5230 JavaScript \u4e5f\u53ef\u4ee5\u4f7f\u7528\u6587\u4ef6\u3002"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"let url = window.URL.createObjectURL(Blob|File)")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"window.URL.revokeObjectURL(url)")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"const textData = 'Hello world!'\n\nconst blob = new Blob([textData], { type: 'text/plain' })\n// \u7ed1\u5b9a\u94fe\u63a5 <a></a>\nconst downloadLink = document.getElementById('a')\ndownloadLink.href = URL.createOObjectURL(blob)\ndownloadLink.download = 'example.txt' // \u8bbe\u7f6e\u4e0b\u8f7d\u6587\u4ef6\u540d\u79f0\n\ndownloadLink.click()\n\nURL.revokeObjectURL(downloadLink.href)\n")),(0,l.kt)("h3",{id:"notifications-api"},"Notifications API"),(0,l.kt)("p",null,"Notifications API \u7528\u4e8e\u5411\u7528\u6237\u663e\u793a\u901a\u77e5\u3002\u7c7b\u4f3c alert()\u5bf9\u8bdd\u6846"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u901a\u77e5\u53ea\u80fd\u5728\u8fd0\u884c\u5728\u5b89\u5168\u4e0a\u4e0b\u6587\u7684\u4ee3\u7801\u4e2d\u88ab\u89e6\u53d1"),(0,l.kt)("li",{parentName:"ul"},"\u901a\u77e5\u5fc5\u987b\u6309\u7167\u6bcf\u4e2a\u6e90\u7684\u539f\u5219\u660e\u786e\u5f97\u5230\u7528\u6237\u5141\u8bb8")),(0,l.kt)("p",null,"requestPermission() \u8fd4\u56de\u4e00\u4e2a\u671f\u7ea6, \u7528\u6237\u5728\u6388\u6743\u5bf9\u8bdd\u6846\u4e0a\u6267\u884c\u64cd\u4f5c\u540e\u8fd9\u4e2a\u671f\u7ea6\u4f1a\u89e3\u51b3\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"Notification.requestPermission().then((permission) => {\n  console.log('User responded to permission request:', permission)\n})\n// granted \u7528\u6237\u6388\u6743\u4e86\u663e\u793a\u901a\u77e5\u7684\u6743\u9650\n// denied \u62d2\u7edd\n\nnew Notification('Title text! ', {\n  body: 'Body text!',\n  image: 'path/to/image.png',\n  vibrate: true,\n})\n// \u5173\u95ed\nconst n = new Notification('I will close in 1000ms')\nsetTimeout(() => n.close(), 1000)\n")),(0,l.kt)("h4",{id:"\u901a\u77e5\u751f\u547d\u5468\u671f\u56de\u8c03"},"\u901a\u77e5\u751f\u547d\u5468\u671f\u56de\u8c03"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"onshow \u901a\u77e5\u663e\u793a\u65f6\u89e6\u53d1"),(0,l.kt)("li",{parentName:"ul"},"onclick \u901a\u77e5\u70b9\u51fb\u65f6\u89e6\u53d1"),(0,l.kt)("li",{parentName:"ul"},"onclose \u901a\u77e5\u6d88\u5931\u6216\u901a\u8fc7 close()\u5173\u95ed\u65f6\u89e6\u53d1"),(0,l.kt)("li",{parentName:"ul"},"onerror \u5728\u53d1\u751f\u9519\u8bef\u963b\u6b62\u901a\u77e5\u663e\u793a\u65f6\u89e6\u53d1")),(0,l.kt)("h3",{id:"page-visibility-api"},"Page Visibility API"),(0,l.kt)("p",null,"\u5982\u679c\u9875\u9762\u88ab\u6700\u5c0f\u5316\u6216\u9690\u85cf\u5728\u5176\u4ed6\u6807\u7b7e\u9875\u540e\u9762, \u90a3\u4e48\u8f6e\u8be2\u670d\u52a1\u5668\u6216\u66f4\u65b0\u52a8\u753b\u7b49\u529f\u80fd\u53ef\u80fd\u5c31\u6ca1\u6709\u5fc5\u8981\u4e86"),(0,l.kt)("p",null,"Page Visibility API \u65e8\u5728\u4e3a\u5f00\u53d1\u8005\u63d0\u4f9b\u9875\u9762\u5bf9\u7528\u6237\u662f\u5426\u53ef\u89c1\u7684\u4fe1\u606f\u3002"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"document.visibilityState"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"hidden"),(0,l.kt)("li",{parentName:"ul"},"visible"),(0,l.kt)("li",{parentName:"ul"},"prerender"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"visibilitychange")," \u4e8b\u4ef6, \u8be5\u4e8b\u4ef6\u4f1a\u5728\u6587\u6863\u4ece\u9690\u85cf\u53d8\u53ef\u89c1\uff08\u6216\u53cd\u4e4b\uff09\u65f6\u89e6\u53d1"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"document.hidden")," \u5e03\u5c14\u503c, \u8868\u793a\u9875\u9762\u662f\u5426\u88ab\u9690\u85cf")),(0,l.kt)("h3",{id:"stream-api"},"Stream API"),(0,l.kt)("h4",{id:"\u6d41"},"\u6d41"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u53ef\u8bfb\u6d41 \u7531 consumer \u8fdb\u884c\u5904\u7406"),(0,l.kt)("li",{parentName:"ol"},"\u53ef\u5199\u6d41 \u7531 producer \u5c06\u6570\u636e\u5199\u5165\u6d41,\u6570\u636e\u5728\u5185\u90e8\u4f20\u5165\u5e95\u5c42\u6570\u636e\u69fd (sink)"),(0,l.kt)("li",{parentName:"ol"},"\u8f6c\u6362\u6d41 \u7531\u4e24\u79cd\u6d41\u7ec4\u6210, \u53ef\u5199\u6d41\u7528\u4e8e\u63a5\u53d7\u6570\u636e,\u53ef\u8bfb\u6d41\u7528\u4e8e\u8f93\u51fa\u6570\u636e, \u4e24\u4e2a\u6d41\u4e4b\u95f4\u662f\u8f6c\u6362\u7a0b\u5e8f transformer")),(0,l.kt)("h4",{id:"\u5757\u5185\u90e8\u961f\u5217\u548c\u53cd\u538b"},"\u5757\u3001\u5185\u90e8\u961f\u5217\u548c\u53cd\u538b"),(0,l.kt)("p",null,"\u6d41\u7684\u57fa\u672c\u5355\u4f4d\u662f\u5757\uff08chunk,\uff09\u901a\u5e38\u662f\u5b9a\u578b\u6570\u7ec4"),(0,l.kt)("p",null,"\u6d41\u5e73\u8861:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u51fa\u53e3\u5904\u7406\u6570\u636e\u7684\u901f\u5ea6 > \u5165\u53e3\u63d0\u4f9b\u6570\u636e\u7684\u901f\u5ea6. \u53ef\u63a5\u53d7"),(0,l.kt)("li",{parentName:"ul"},"\u6d41\u51fa\u548c\u6d41\u5165\u5747\u8861 \u7406\u60f3"),(0,l.kt)("li",{parentName:"ul"},"\u51fa\u53e3\u5904\u7406\u6570\u636e\u7684\u901f\u5ea6 < \u5165\u53e3\u63d0\u4f9b\u6570\u636e\u7684\u901f\u5ea6\u6bd4. \u9700\u8981\u5904\u7406")),(0,l.kt)("p",null,"\u6d41\u4e0d\u80fd\u5141\u8bb8\u5176\u5185\u90e8\u961f\u5217\u65e0\u9650\u589e\u5927, \u56e0\u6b64\u5b83\u4f1a\u4f7f\u7528\u53cd\u538b\uff08backpressure\uff09\u901a\u77e5\u6d41\u5165\u53e3\u505c\u6b62\u53d1\u9001\u6570\u636e, \u76f4\u5230\u961f\u5217\u5927\u5c0f\u964d\u5230\u67d0\u4e2a\u65e2\u5b9a\u7684\u9608\u503c\u4e4b\u4e0b"),(0,l.kt)("p",null,"\u8fd9\u4e2a\u9608\u503c\u7531\u6392\u5217\u7b56\u7565\u51b3\u5b9a, \u8fd9\u4e2a\u7b56\u7565\u5b9a\u4e49\u4e86\u5185\u90e8\u961f\u5217\u53ef\u4ee5\u5360\u7528\u7684\u6700\u5927\u5185\u5b58, \u5373\u9ad8\u6c34\u4f4d\u7ebf\uff08high water mark\uff09\u3002"),(0,l.kt)("p",null,"\u53ef\u8bfb\u6d41"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"// \u6a21\u62df\u8f93\u5165 1,2,3,4,5...\nasync function* ints() {\n  for (let i = 0; i < 5; ++i) {\n    yield await new Promise((resolve) => setTimeout(resolve, 1000, i))\n  }\n}\n\n// \u5047\u8bbe\u8f93\u5165, \u521b\u5efa\u4e00\u4e2a\u53ef\u8bfb\u6d41\nconst readableStream = new ReadableStream({\n  async start(controller) {\n    // \u4f7f\u7528\u5f02\u6b65\u751f\u6210\u5668\u51fd\u6570 ints() \u751f\u6210\u9012\u589e\u6574\u6570, \u5e76\u5c06\u5b83\u4eec\u63a8\u9001\u5230\u6d41\u4e2d\n    for await (let chunk of ints()) {\n      controller.enqueue(chunk)\n    }\n    // \u6570\u636e\u63a8\u9001\u5b8c\u6bd5, \u5173\u95ed\u6d41\n    controller.close()\n  },\n})\n\n// \u6d88\u8d39\u8005\n\n;(async function () {\n  while (true) {\n    const { done, value } = await readableStreamDefaultReader.read()\n    if (done) {\n      break\n    } else {\n      console.log(value)\n    }\n  }\n})()\n")),(0,l.kt)("p",null,"\u53ef\u5199\u6d41"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"const writableStream = new WritableStream({\n  // write \u65b9\u6cd5\u4f1a\u5728\u6bcf\u6b21\u5199\u5165\u65f6\u88ab\u8c03\u7528\n  write(value) {\n    console.log(value)\n  },\n})\n\nconst writableStreamDefaultWriter = writableStream.getWriter()\n\n//\u751f\u4ea7\u8005\n;(async function () {\n  for await (let chunk of ints()) {\n    await writableStreamDefaultWriter.ready\n    writableStreamDefaultWriter.write(chunk)\n  }\n  writableStreamDefaultWriter.close()\n})()\n")),(0,l.kt)("p",null,"\u8f6c\u6362\u6d41"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"const { writable, readable } = new TransformStream({\n  // transform \u65b9\u6cd5\u5728\u6bcf\u4e2a\u6570\u636e\u5757\u4f20\u9012\u65f6\u8c03\u7528\n  transform(chunk, controller) {\n    // \u5c06\u4f20\u5165\u7684\u6570\u636e\u5757\u4e58\u4ee5 2 \u5e76\u63a8\u9001\u5230\u53ef\u8bfb\u6d41\u4e2d\n    controller.enqueue(chunk * 2)\n  },\n})\n\nconst readableStreamDefaultReader = readable.getReader()\nconst writableStreamDefaultWriter = writable.getWriter()\n\n// \u6d88\u8d39\u8005\uff1a\u4ece\u53ef\u8bfb\u6d41\u8bfb\u53d6\u6570\u636e\u5e76\u8fdb\u884c\u6d88\u8d39\n;(async function () {\n  while (true) {\n    const { done, value } = await readableStreamDefaultReader.read()\n    if (done) {\n      break\n    } else {\n      console.log(value)\n    }\n  }\n})()\n\n// \u751f\u4ea7\u8005\uff1a\u5c06\u4ece ints() \u751f\u6210\u5668\u83b7\u53d6\u7684\u6570\u636e\u5757\u5199\u5165\u53ef\u5199\u6d41\n;(async function () {\n  for await (let chunk of ints()) {\n    await writableStreamDefaultWriter.ready\n    writableStreamDefaultWriter.write(chunk)\n  }\n  writableStreamDefaultWriter.close()\n})()\n")),(0,l.kt)("h4",{id:"\u7ba1\u9053\u8fde\u63a5\u6d41"},"\u7ba1\u9053\u8fde\u63a5\u6d41"),(0,l.kt)("p",null,"\u4f7f\u7528 pipeThrough() \u65b9\u6cd5\u628a ReadableStream \u63a5\u5165 TransformStream"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"// \u521b\u5efa\u4e00\u4e2a\u53ef\u8bfb\u6d41, \u751f\u6210\u9012\u589e\u6574\u6570\u5757\nconst integerStream = new ReadableStream({\n  async start(controller) {\n    for await (let chunk of ints()) {\n      controller.enqueue(chunk)\n    }\n    controller.close()\n  },\n})\n\n// \u521b\u5efa\u4e00\u4e2a\u8f6c\u6362\u6d41, \u5c06\u6574\u6570\u5757\u7ffb\u500d\nconst doublingStream = new TransformStream({\n  async transform(chunk, controller) {\n    // \u5c06\u63a5\u6536\u5230\u7684\u6574\u6570\u5757\u7ffb\u500d, \u5e76\u5c06\u7ed3\u679c\u63a8\u9001\u5230\u8f93\u51fa\n    controller.enqueue(chunk * 2)\n  },\n})\n\n// \u901a\u8fc7\u7ba1\u9053\u8fde\u63a5\u6d41\uff1a\u5c06 integerStream \u8f93\u5165\u8fde\u63a5\u5230 doublingStream, \u5f97\u5230 pipedStream\nconst pipedStream = integerStream.pipeThrough(doublingStream)\n\nconst pipedStreamDefaultReader = pipedStream.getReader()\n\n// \u6d88\u8d39\u8005\uff1a\u4ece\u8fde\u63a5\u6d41\u4e2d\u8bfb\u53d6\u6570\u636e\u5e76\u5904\u7406\n;(async function () {\n  while (true) {\n    const { done, value } = await pipedStreamDefaultReader.read()\n    if (done) {\n      break\n    } else {\n      console.log(value)\n    }\n  }\n})()\n")),(0,l.kt)("p",null,"pipeTo() \u65b9\u6cd5\u4e5f\u53ef\u4ee5\u5c06 ReadableStream \u8fde\u63a5\u5230 WritableStream"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"// \u521b\u5efa\u4e00\u4e2a\u53ef\u8bfb\u6d41, \u5c06\u9012\u589e\u6574\u6570\u5199\u5165\u6d41\u4e2d\nconst integerStream = new ReadableStream({\n  async start(controller) {\n    for await (let chunk of ints()) {\n      controller.enqueue(chunk)\n    }\n    controller.close()\n  },\n})\n\n// \u521b\u5efa\u4e00\u4e2a\u53ef\u5199\u6d41, \u7528\u4e8e\u8f93\u51fa\u5199\u5165\u7684\u6570\u636e\nconst writableStream = new WritableStream({\n  // write \u65b9\u6cd5\u4f1a\u5728\u6bcf\u6b21\u5199\u5165\u65f6\u88ab\u8c03\u7528\n  write(value) {\n    console.log(value) // \u5c06\u5199\u5165\u7684\u503c\u6253\u5370\u5230\u63a7\u5236\u53f0\n  },\n})\n\n// \u5c06\u53ef\u8bfb\u6d41\u8fde\u63a5\u5230\u53ef\u5199\u6d41, \u4f7f\u6570\u636e\u4ece\u53ef\u8bfb\u6d41\u6d41\u5165\u53ef\u5199\u6d41\nconst pipedStream = integerStream.pipeTo(writableStream)\n")),(0,l.kt)("h3",{id:"\u8ba1\u65f6-api"},"\u8ba1\u65f6 API"),(0,l.kt)("p",null,"Performance \u63a5\u53e3 ",(0,l.kt)("inlineCode",{parentName:"p"},"window.performance")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"performance.now()")," \u5fae\u79d2\u7ea7"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"window.performance.timeOrigin")," \u8fd4\u56de\u8ba1\u65f6\u5668\u521d\u59cb\u5316\u65f6\u5168\u5c40\u7cfb\u7edf\u65f6\u949f\u7684\u503c"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"User Timing API \u7528\u4e8e\u8bb0\u5f55\u548c\u5206\u6790\u81ea\u5b9a\u4e49\u6027\u80fd\u6761\u76ee"),(0,l.kt)("li",{parentName:"ul"},"Navigation Timing API \u63d0\u4f9b\u4e86\u9ad8\u7cbe\u5ea6\u65f6\u95f4\u6233, \u7528\u4e8e\u5ea6\u91cf\u5f53\u524d\u9875\u9762\u52a0\u8f7d\u901f\u5ea6\u3002"),(0,l.kt)("li",{parentName:"ul"},"Resource Timing API \u63d0\u4f9b\u4e86\u9ad8\u7cbe\u5ea6\u65f6\u95f4\u6233, \u7528\u4e8e\u5ea6\u91cf\u5f53\u524d\u9875\u9762\u52a0\u8f7d\u65f6\u8bf7\u6c42\u8d44\u6e90\u7684\u901f\u5ea6")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"performance.mark('start')\n// performance.getEntriesByType \u4e2d\u7684\u53c2\u6570 'mark' 'navigate' 'resource'\n// \u53ef\u4f9d\u6b21\u83b7\u5f97\u4e0a\u8ff0\u4e09\u4e2aAPI\u5bf9\u8c61\nconst [endMark, startMark] = performance.getEntriesByType('mark')\n\n// PerformanceMark {\n//     name: \"start\",\n//     entryType: \"mark\",\n//     startTime: 269.8800000362098,\n//     duration: 0\n// }\n")),(0,l.kt)("h3",{id:"web-components"},"Web Components"),(0,l.kt)("p",null,"\u53ef\u91cd\u7528 \u5b9a\u5236 ->\u3000\u5143\u7d20"),(0,l.kt)("h4",{id:"html-\u6a21\u7248"},"HTML \u6a21\u7248"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u4f7f\u7528 DocumentFragment")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"const fragment = new DocumentFragment()\nconst foo = document.querySelector('#foo')\n\nfragment.appendChild(document.createElement('p'))\n// ...\n\nfoo.appendChild(fragment)\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u4f7f\u7528 template")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-html"},'<div id="foo"></div>\n\x3c!-- \u5728\u6d4f\u89c8\u5668\u4e2d\u6e32\u67d3\u65f6, p \u4e2d\u6587\u672c\u4e0d\u4f1a\u88ab\u6e32\u67d3\u5230\u9875\u9762\u4e0a --\x3e\n<template id="bar">\n  <p>...</p>\n  \x3c!-- \u6a21\u7248css --\x3e\n  <style></style>\n  \x3c!-- \u6a21\u677fscript --\x3e\n  <script>\n    console.log(\'Templatescriptexecuted\')\n  <\/script>\n</template>\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"const foo = document.querySelector('#foo')\nconst fragment = document.querySelector('#bar').content\n\nfoo.appendChild(fragment)\n\n// \u590d\u5236\u6a21\u7248\nfoo.appendChild(document.importNode(fragment, true))\n")),(0,l.kt)("h4",{id:"shadow-dom"},"Shadow DOM"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"element.attachShadow({ mode: 'open' })")),(0,l.kt)("p",null,"\u5f71\u5b50 DOM \u7684\u5185\u5bb9\u4f1a\u5b9e\u9645\u6e32\u67d3\u5230\u9875\u9762\u4e0a"),(0,l.kt)("p",null,"CSS \u6837\u5f0f\u548c CSS \u9009\u62e9\u7b26\u53ef\u4ee5\u9650\u5236\u5728\u5f71\u5b50 DOM \u5b50\u6811\u800c\u4e0d\u662f\u6574\u4e2a\u9876\u7ea7 DOM \u6811\u4e2d"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"for (let color of ['red', 'green', 'blue']) {\n  // shadow host\n  const host = document.createElement('div') // react <></>\n  // shadow root\n  const shadowRoot = host.attachShadow({ mode: 'open' })\n\n  shadowRoot.innerHTML = `\n    <p>Make me ${color}</p>\n    <style>\n    p{\n      color: ${color}\n    }\n    </style>\n    `\n}\n")),(0,l.kt)("p",null,"\u5f71\u5b50 DOM \u4e00\u6dfb\u52a0\u5230\u5143\u7d20\u4e2d, \u6d4f\u89c8\u5668\u5c31\u4f1a\u8d4b\u4e88\u5b83\u6700\u9ad8\u4f18\u5148\u7ea7, \u4f18\u5148\u6e32\u67d3\u5b83\u7684\u5185\u5bb9\u800c\u4e0d\u662f\u539f\u6765\u7684\u6587\u672c"),(0,l.kt)("h4",{id:"slot"},"slot"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"<slot>")," \u7684\u4f5c\u7528\u5c31\u662f\u7ed9\u6a21\u677f\u5143\u7d20\u4f20\u503c, \u589e\u5f3a\u6a21\u677f\u5143\u7d20\u7684\u7075\u6d3b\u6027\u548c\u901a\u7528\u6027\u3002"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"name")," \u7684\u503c\u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"slot")," \u7684\u503c\u5339\u914d"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-html"},'<template>\n  <div>\n    My name is <slot name="username">username</slot>\n  </div>\n</template>\n\n<my-card>\n  <span slot="username">Leo</slot>\n</my-card>\n<my-card>\n  <span slot="username">Louis</slot>\n</my-card>\n')),(0,l.kt)("h4",{id:"\u81ea\u5b9a\u4e49\u5143\u7d20"},"\u81ea\u5b9a\u4e49\u5143\u7d20"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"customElements.define(name, constructor, options)")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"name")," \u81ea\u5b9a\u4e49\u6807\u7b7e\u540d\u3002\u6ce8\u610f\uff1a\u5b83\u4e0d\u80fd\u662f\u5355\u4e2a\u5355\u8bcd, \u4e14\u5176\u4e2d\u5fc5\u987b\u8981\u6709\u77ed\u6a2a\u7ebf, \u6bd4\u5982\uff1amy-card \u8fd9\u6837\u7684\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"constructor")," \u81ea\u5b9a\u4e49\u5143\u7d20\u6784\u9020\u5668, \u5b83\u53ef\u4ee5\u63a7\u5236\u5143\u7d20\u7684\u8868\u73b0\u5f62\u5f0f\u3001\u884c\u4e3a\u548c\u751f\u547d\u5468\u671f\u7b49\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"options")," \u4e00\u4e2a\u5305\u542b extends \u5c5e\u6027\u7684\u914d\u7f6e\u5bf9\u8c61, \u662f\u53ef\u9009\u53c2\u6570\u3002\u5b83\u6307\u5b9a\u4e86\u6240\u521b\u5efa\u7684\u5143\u7d20\u7ee7\u627f\u81ea\u54ea\u4e2a\u5185\u7f6e\u5143\u7d20, \u53ef\u4ee5\u7ee7\u627f\u4efb\u4f55\u5185\u7f6e\u5143\u7d20\u3002")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"class MyCard extends HTMLParagraphElement {\n  constructor() {\n    super()\n    // ...\n  }\n}\n// \u6ce8\u518c\u81ea\u5b9a\u4e49\u6807\u7b7e\ncustomElements.define('my-card', MyCard)\n")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u751f\u547d\u5468\u671f\u51fd\u6570"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"constructor()")),(0,l.kt)("td",{parentName:"tr",align:null},"\u5728\u521b\u5efa\u5143\u7d20\u5b9e\u4f8b\u6216\u5c06\u5df2\u6709 DOM \u5143\u7d20\u5347\u7ea7\u4e3a\u81ea\u5b9a\u4e49\u5143\u7d20\u65f6\u8c03\u7528\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"connectedCallback()")),(0,l.kt)("td",{parentName:"tr",align:null},"\u5728\u6bcf\u6b21\u5c06\u8fd9\u4e2a\u81ea\u5b9a\u4e49\u5143\u7d20\u5b9e\u4f8b\u6dfb\u52a0\u5230 DOM \u4e2d\u65f6\u8c03\u7528\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"disconnectedCallback()")),(0,l.kt)("td",{parentName:"tr",align:null},"\u5728\u6bcf\u6b21\u5c06\u8fd9\u4e2a\u81ea\u5b9a\u4e49\u5143\u7d20\u5b9e\u4f8b\u4ece DOM \u4e2d\u79fb\u9664\u65f6\u8c03\u7528\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"attributeChangedCallback()")),(0,l.kt)("td",{parentName:"tr",align:null},"\u5728\u6bcf\u6b21\u53ef\u89c2\u5bdf\u5c5e\u6027\u7684\u503c\u53d1\u751f\u53d8\u5316\u65f6\u8c03\u7528\u3002\u521d\u59cb\u503c\u7684\u5b9a\u4e49\u4e5f\u7b97\u4e00\u6b21\u53d8\u5316\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"adoptedCallback()")),(0,l.kt)("td",{parentName:"tr",align:null},"\u5728\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"td"},"document.adoptNode()")," \u5c06\u8fd9\u4e2a\u81ea\u5b9a\u4e49\u5143\u7d20\u5b9e\u4f8b\u79fb\u52a8\u5230\u65b0\u6587\u6863\u5bf9\u8c61\u65f6\u8c03\u7528\u3002")))),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"EXAMPLE")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-html"},'<template id="card_layout">\n  <style>\n    * {\n      box-sizing: border-box;\n    }\n    :host {\n      display: inline-block;\n      width: 400px;\n      height: 240px;\n      border: 1px solid black;\n      border-radius: 10px;\n      box-shadow: -2px -2px 5px 0px #7a8489;\n    }\n  </style>\n  <div class="container">\n    \x3c!-- \u540d\u5b57 --\x3e\n    <div class="card-body">\n      <div class="info-column">\n        <div class="info-title">name</div>\n      </div>\n      <div class="info-content">\n        <span name="username">Nicholas</span>\n      </div>\n    </div>\n    \x3c!-- \u7f16\u53f7 --\x3e\n    <div class="card-footer">\n      <div class="info-column">\n        <div class="info-title">number</div>\n      </div>\n      <div class="info-content">\n        <slot name="number">42</slot>\n      </div>\n    </div>\n  </div>\n</template>\n\n\x3c!-- \u4f7f\u7528 --\x3e\n<my-card>\n  <span slot="username"></span>\n  <span slot="number"></span>\n</my-card>\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"class MyCard extends HTMLElement {\n  constructor() {\n    super()\n    this.shadow = this.attachShadow({ mode: 'open' })\n    let tempEle = document.getElementById('card_layout')\n    // shadow DOM \u590d\u5236\u5f15\u5165\n    this.shadow.appendChild(document.importNode(tempEle.content, true))\n  }\n}\n\ncustomElements.define('my-card', MyCard)\n")),(0,l.kt)("h3",{id:"web-cryptography-api"},"Web Cryptography API"),(0,l.kt)("p",null,"\u5bc6\u7801\u5b66\u7b97\u6cd5"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"// \u968f\u673a\u6570\nconst array = new Uint8Array(2)\nconsole.log(crypto.getRandomValues(array))\n")),(0,l.kt)("p",null,"// todo"),(0,l.kt)("h2",{id:"json"},"JSON"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"JSON.stringify()")),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u8fc7\u6ee4\u7ed3\u679c")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"let book = {\n  title: 'Professional JavaScript',\n  authors: ['Nicholas C. Zakas', 'Matt Frisbie'],\n  edition: 4,\n  year: 2017,\n}\n\n// \u9009\u62e9\u6307\u5b9a\u53c2\u6570\n// \u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e3a \u6570\u7ec4\nlet jsonText = JSON.stringify(book, ['title', 'edition'])\n\n// { title: 'Professional JavaScript', edition: 4 }\n\n// \u6539\u53d8\u53c2\u6570\u5e8f\u5217\u5316\n// \u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e3a \u51fd\u6570\nlet jsonText = JSON.stringify(book, (key, value) => {\n  switch (key) {\n    case 'authors':\n      return value.join(',')\n    case 'year':\n      return 5000\n    case 'edition':\n      return undefined\n    default:\n      return value\n  }\n})\n\n// {\n//   title: 'Professional JavaScript',\n//   authors: 'Nicholas C. Zakas, Matt Frisbie',\n//   year: 5000,\n// }\n")),(0,l.kt)("ol",{start:2},(0,l.kt)("li",{parentName:"ol"},"\u5b57\u7b26\u4e32\u7f29\u8fdb")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"// \u7b2c\u4e09\u4e2a\u53c2\u6570\u63a7\u5236\u7f29\u8fdb\u548c\u7a7a\u683c\n\nlet jsonText = JSON.stringify(book, null, 4)\n\nlet jsonText = JSON.stringify(book, null, '--')\n")),(0,l.kt)("ol",{start:3},(0,l.kt)("li",{parentName:"ol"},"toJSON() \u65b9\u6cd5")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'// \u81ea\u5b9a\u4e49JSON\u5e8f\u5217\u5316\n\nlet book = {\n  //...\n  toJSON: function () {\n    // \u4e0d\u8981\u7528\u7bad\u5934\u51fd\u6570, \u5426\u5219this \u662f\u5168\u5c40\u4f5c\u7528\u57df\n    return this.title\n  },\n}\n// \u8c03\u7528JSON.stringify\u65f6, \u53ea\u4f1a\u5f97\u5230\u5b57\u7b26\u4e32\n// "Professional JavaScript"\n')),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"JSON.parse()")),(0,l.kt)("h2",{id:"\u7f51\u7edc\u8bf7\u6c42\u4e0e\u8fdc\u7a0b\u8d44\u6e90"},"\u7f51\u7edc\u8bf7\u6c42\u4e0e\u8fdc\u7a0b\u8d44\u6e90"),(0,l.kt)("p",null,"Ajax\uff08Asynchronous JavaScript and XML, \u5373\u5f02\u6b65 JavaScript + XML\uff09"),(0,l.kt)("h3",{id:"xmlhttprequest"},"XMLHttpRequest"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"let xhr = new XHLHttpRequest()\n// \u8bf7\u6c42\u65b9\u5f0f url \u662f\u5426\u5f02\u6b65, false\u4e3a\u540c\u6b65\nxhr.open('get', url, false)\nxhr.send(body)\n")),(0,l.kt)("p",null,"\u6536\u5230\u670d\u52a1\u5668\u54cd\u5e94\u540e, XHR \u7684\u4e00\u4e0b\u5c5e\u6027\u4f1a\u88ab\u586b\u5145\u6570\u636e:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"responseText"),"\uff1a\u4f5c\u4e3a\u54cd\u5e94\u4f53\u8fd4\u56de\u7684\u6587\u672c\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"responseXML"),'\uff1a\u5982\u679c\u54cd\u5e94\u7684\u5185\u5bb9\u7c7b\u578b\u662f"text/xml"\u6216"application/xml", \u90a3\u5c31\u662f\u5305\u542b\u54cd\u5e94\u6570\u636e\u7684 XMLDOM \u6587\u6863\u3002'),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"status"),"\uff1a\u54cd\u5e94\u7684 HTTP \u72b6\u6001\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"statusText"),"\uff1a\u54cd\u5e94\u7684 HTTP \u72b6\u6001\u63cf\u8ff0")),(0,l.kt)("p",null,"XHR \u5bf9\u8c61\u6709\u4e00\u4e2a readyState, \u8868\u793a\u5f53\u524d\u5904\u5728\u8bf7\u6c42/\u54cd\u5e94\u8fc7\u7a0b\u7684\u54ea\u4e2a\u9636\u6bb5"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"0: Uninitialized \u5c1a\u672a\u8c03\u7528 open()"),(0,l.kt)("li",{parentName:"ul"},"1: Open \u5c1a\u672a\u8c03\u7528 send()"),(0,l.kt)("li",{parentName:"ul"},"2: Sent \u5c1a\u672a\u6536\u5230\u54cd\u5e94"),(0,l.kt)("li",{parentName:"ul"},"3: Receiving \u6536\u5230\u90e8\u5206\u54cd\u5e94"),(0,l.kt)("li",{parentName:"ul"},"4: Complete \u6536\u5230\u6240\u6709\u54cd\u5e94")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"let xhr = new XMLHttpRequest()\nxhr.onreadystatechange = function(){\n  if(xhr.readyState == 4)\n  //\n  else\n  //\n}\n\nxhr.abort() // \u53d6\u6d88\u5f02\u6b65\u8bf7\u6c42\n")),(0,l.kt)("h4",{id:"http-\u5934\u90e8"},"HTTP \u5934\u90e8"),(0,l.kt)("p",null,"\u9ed8\u8ba4\u60c5\u51b5\u4e0b, XHR \u8bf7\u6c42\u4f1a\u53d1\u9001\u4ee5\u4e0b\u5934\u90e8\u5b57\u6bb5"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u5934\u90e8\u5b57\u6bb5"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Accept"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6d4f\u89c8\u5668\u53ef\u4ee5\u5904\u7406\u7684\u5185\u5bb9\u7c7b\u578b")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Accept-Charset"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6d4f\u89c8\u5668\u53ef\u4ee5\u663e\u793a\u7684\u5b57\u7b26\u96c6")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Accept-Encoding"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6d4f\u89c8\u5668\u53ef\u4ee5\u5904\u7406\u7684\u538b\u7f29\u7f16\u7801\u7c7b\u578b")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Accept-Language"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6d4f\u89c8\u5668\u4f7f\u7528\u7684\u8bed\u8a00")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Connection"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6d4f\u89c8\u5668\u4e0e\u670d\u52a1\u5668\u7684\u8fde\u63a5\u7c7b\u578b")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Cookie"),(0,l.kt)("td",{parentName:"tr",align:null},"\u9875\u9762\u4e2d\u8bbe\u7f6e\u7684 Cookie")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Host"),(0,l.kt)("td",{parentName:"tr",align:null},"\u53d1\u9001\u8bf7\u6c42\u7684\u9875\u9762\u6240\u5728\u7684\u57df")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Referer"),(0,l.kt)("td",{parentName:"tr",align:null},"\u53d1\u9001\u8bf7\u6c42\u7684\u9875\u9762\u7684 URI\uff08\u62fc\u5199\u9519\u8bef, \u5e94\u4e3a Referrer\uff09")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"User-Agent"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6d4f\u89c8\u5668\u7684\u7528\u6237\u4ee3\u7406\u5b57\u7b26\u4e32")))),(0,l.kt)("p",null,"\u5982\u679c\u9700\u8981\u53d1\u9001\u989d\u5916\u7684\u8bf7\u6c42\u5934\u90e8, \u5fc5\u987b\u5728 open()\u4e4b\u540e\u3001send()\u4e4b\u524d\u8c03\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"setRequestHeader()")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"xhr.open()\nxhr.setRequestHeader('MyHeader', 'MyValue')\nxhr.send()\n// \u83b7\u53d6\u54cd\u5e94\u5934\u90e8\nlet myHeader = xhr.getResponseHeader('MyHeader')\nlet allHeaders = xhr.getAllResponseHeaders()\n")),(0,l.kt)("h4",{id:"get-post"},"GET POST"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"function submitData() {\n  let xhr = new XMLHttpRequest()\n  xhr.onreadystatechange = function () {\n    if (xhr.readyState == 4) {\n      if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {\n        alert(xhr.responseText)\n      } else {\n        alert('Request was unsuccessful: ' + xhr.status)\n      }\n    }\n  }\n  xhr.open('post', 'post-example.php', true)\n  xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded')\n  let form = document.getElementById('user-info')\n  xhr.send(serialize(form))\n}\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-php"},"<?php\n  header(\"Content-Type: text/plain\");\n  echo <<<EOF\n  Name: {$_POST['user-name']}\n  Email: {$_POST['user-email']}\n  EOF;\n?>\n")),(0,l.kt)("h4",{id:"formdata-\u7c7b\u578b"},"FormData \u7c7b\u578b"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"let xhr = new XMLHttpRequest()\nxhr.open('post', 'example.php', true)\nlet form = document.getElementById('form')\nxhr.send(new FormDate(form))\n")),(0,l.kt)("h4",{id:"\u8d85\u65f6"},"\u8d85\u65f6"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"let xhr = new XMLHttpRequest()\nxhr.onreadystatechange = function () {}\nxhr.open('get', 'example.php', true)\nxhr.timeout = 1000\nxhr.ontimeout = function () {\n  alert('\u8bf7\u6c42\u8d85\u65f6')\n}\nxhr.send(null)\n")),(0,l.kt)("p",null,"\u8d85\u65f6\u4e4b\u540e\u4ecd\u4f1a\u89e6\u53d1 onreadystatechange \u4e8b\u4ef6, readyState \u4e3a 4, \u4f46\u662f\u8bbf\u95ee status \u4f1a\u62a5\u9519"),(0,l.kt)("h4",{id:"overridemimetype\u65b9\u6cd5"},"overrideMimeType()\u65b9\u6cd5"),(0,l.kt)("p",null,"\u7528\u4e8e\u91cd\u5199 XHR \u54cd\u5e94(\u670d\u52a1\u5668)\u7684 MIME \u7c7b\u578b"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"xhr.overrideMimeType('text/xml')")),(0,l.kt)("p",null,"\u5fc5\u987b\u5728\u8c03\u7528 send()\u4e4b\u524d\u8c03\u7528 overrideMimeType()"),(0,l.kt)("h3",{id:"\u8fdb\u5ea6\u4e8b\u4ef6"},"\u8fdb\u5ea6\u4e8b\u4ef6"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u5934\u90e8\u5b57\u6bb5"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"loadstart"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5728\u63a5\u6536\u5230\u54cd\u5e94\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u65f6\u89e6\u53d1\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"progress"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5728\u63a5\u6536\u54cd\u5e94\u671f\u95f4\u53cd\u590d\u89e6\u53d1\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"error"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5728\u8bf7\u6c42\u51fa\u9519\u65f6\u89e6\u53d1\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"abort"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5728\u8c03\u7528 abort()\u7ec8\u6b62\u8fde\u63a5\u65f6\u89e6\u53d1\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"load"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5728\u6210\u529f\u63a5\u6536\u5b8c\u54cd\u5e94\u65f6\u89e6\u53d1\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"loadend"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5728\u901a\u4fe1\u5b8c\u6210\u65f6, \u4e14\u5728 error\u3001abort \u6216 load \u4e4b\u540e\u89e6\u53d1\u3002")))),(0,l.kt)("h4",{id:"progress-\u4e8b\u4ef6"},"progress \u4e8b\u4ef6"),(0,l.kt)("p",null,"\u6bcf\u6b21\u89e6\u53d1\u65f6, onprogress \u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u90fd\u4f1a\u6536\u5230 event \u5bf9\u8c61, \u5176 target \u5c5e\u6027\u662f XHR \u5bf9\u8c61, \u4e14\u5305\u542b 3 \u4e2a\u989d\u5916\u5c5e\u6027\uff1alengthComputable\u3001position \u548c totalSize"),(0,l.kt)("h3",{id:"cors"},"CORS"),(0,l.kt)("p",null,"\u8de8\u6e90\u8d44\u6e90\u5171\u4eab\uff08CORS, Cross-Origin Resource Sharing\uff09"),(0,l.kt)("p",null,"\u5bf9\u4e8e\u7b80\u5355\u7684\u8bf7\u6c42, \u5728\u53d1\u9001\u65f6\u4f1a\u6709\u4e00\u4e2a\u989d\u5916\u7684\u5934\u90e8\u53eb Origin, \u5305\u542b\u53d1\u9001\u8bf7\u6c42\u7684\u9875\u9762\u7684\u6e90\uff08\u534f\u8bae\u3001\u57df\u540d\u548c\u7aef\u53e3\uff09\u3002"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Origin: http://www.nczonline.net")),(0,l.kt)("p",null,'\u5982\u679c\u670d\u52a1\u5668\u51b3\u5b9a\u54cd\u5e94\u8bf7\u6c42, \u90a3\u4e48\u5e94\u8be5\u53d1\u9001 Access-Control-Allow-Origin \u5934\u90e8, \u5305\u542b\u76f8\u540c\u7684\u6e90\uff1b\u6216\u8005\u5982\u679c\u8d44\u6e90\u662f\u516c\u5f00\u7684, \u90a3\u4e48\u5c31\u5305\u542b"\uff0a"'),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Access-Control-Allow-Origin: http://www.nczonline.net")),(0,l.kt)("p",null,"\u51fa\u4e8e\u5b89\u5168\u8003\u8651, \u8de8\u57df XHR \u5bf9\u8c61\u4e5f\u65bd\u52a0\u4e86\u4e00\u4e9b\u989d\u5916\u9650\u5236\u3002"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u4e0d\u80fd\u4f7f\u7528 setRequestHeader() \u8bbe\u7f6e\u81ea\u5b9a\u4e49\u5934\u90e8"),(0,l.kt)("li",{parentName:"ul"},"\u4e0d\u80fd\u53d1\u9001\u548c\u63a5\u6536 cookie"),(0,l.kt)("li",{parentName:"ul"},"getAllResponseHeaders() \u65b9\u6cd5\u59cb\u7ec8\u8fd4\u56de\u7a7a\u5b57\u7b26\u4e32")),(0,l.kt)("h4",{id:"\u9884\u68c0\u8bf7\u6c42-preflight-request"},"\u9884\u68c0\u8bf7\u6c42 preflight request"),(0,l.kt)("p",null,"CORS \u901a\u8fc7\u4e00\u79cd\u53eb\u9884\u68c0\u8bf7\u6c42\u7684\u670d\u52a1\u5668\u9a8c\u8bc1\u673a\u5236, \u5141\u8bb8\u4f7f\u7528\u81ea\u5b9a\u4e49\u5934\u90e8\u3001\u590d\u6742\u8bf7\u6c42, \u4ee5\u53ca\u4e0d\u540c\u8bf7\u6c42\u4f53\u5185\u5bb9\u7c7b\u578b\u3002\u5728\u53d1\u9001\u590d\u6742\u8bf7\u6c42\u65f6, \u4f1a\u5148\u5411\u670d\u52a1\u5668\u53d1\u9001\u4e00\u4e2a\u9884\u68c0\u8bf7\u6c42, \u8fd9\u4e2a\u8bf7\u6c42\u4f7f\u7528 OPTIONS \u65b9\u6cd5\u53d1\u9001\u5e76\u5305\u542b\u4ee5\u4e0b\u5934\u90e8:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Origin\uff1a\u4e0e\u7b80\u5355\u8bf7\u6c42\u76f8\u540c\u3002"),(0,l.kt)("li",{parentName:"ul"},"Access-Control-Request-Method\uff1a\u8bf7\u6c42\u5e0c\u671b\u4f7f\u7528\u7684\u65b9\u6cd5\u3002"),(0,l.kt)("li",{parentName:"ul"},"Access-Control-Request-Headers:\uff08\u53ef\u9009\uff09\u8981\u4f7f\u7528\u7684\u9017\u53f7\u5206\u9694\u7684\u81ea\u5b9a\u4e49\u5934\u90e8\u5217\u8868\u3002")),(0,l.kt)("p",null,"\u5728\u8fd9\u4e2a\u8bf7\u6c42\u53d1\u9001\u540e, \u670d\u52a1\u5668\u53ef\u4ee5\u786e\u5b9a\u662f\u5426\u5141\u8bb8\u8fd9\u79cd\u7c7b\u578b\u7684\u8bf7\u6c42\u3002\u670d\u52a1\u5668\u4f1a\u901a\u8fc7\u5728\u54cd\u5e94\u4e2d\u53d1\u9001\u5982\u4e0b\u5934\u90e8\u4e0e\u6d4f\u89c8\u5668\u6c9f\u901a\u8fd9\u4e9b\u4fe1\u606f\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Access-Control-Allow-Origin\uff1a\u5141\u8bb8\u6d4f\u89c8\u5668\u8bbf\u95ee\u7684\u6e90\u3002"),(0,l.kt)("li",{parentName:"ul"},"Access-Control-Allow-Methods\uff1a\u5141\u8bb8\u7684\u65b9\u6cd5\uff08\u9017\u53f7\u5206\u9694\u7684\u5217\u8868\uff09\u3002"),(0,l.kt)("li",{parentName:"ul"},"Access-Control-Allow-Headers\uff1a\u670d\u52a1\u5668\u5141\u8bb8\u7684\u5934\u90e8\uff08\u9017\u53f7\u5206\u9694\u7684\u5217\u8868\uff09\u3002"),(0,l.kt)("li",{parentName:"ul"},"Access-Control-Max-Age\uff1a\u7f13\u5b58\u9884\u68c0\u8bf7\u6c42\u7684\u79d2\u6570\u3002")),(0,l.kt)("p",null,"\u9884\u68c0\u8bf7\u6c42\u8fd4\u56de\u540e, \u7ed3\u679c\u4f1a\u6309\u54cd\u5e94\u6307\u5b9a\u7684\u65f6\u95f4\u7f13\u5b58\u4e00\u6bb5\u65f6\u95f4\u3002\u6362\u53e5\u8bdd\u8bf4, \u53ea\u6709\u7b2c\u4e00\u6b21\u53d1\u9001\u8fd9\u79cd\u7c7b\u578b\u7684\u8bf7\u6c42\u65f6\u624d\u4f1a\u591a\u53d1\u9001\u4e00\u6b21\u989d\u5916\u7684 HTTP \u8bf7\u6c42"),(0,l.kt)("h4",{id:"\u51ed\u636e\u8bf7\u6c42"},"\u51ed\u636e\u8bf7\u6c42"),(0,l.kt)("p",null,"\u9ed8\u8ba4\u60c5\u51b5\u4e0b, \u8de8\u6e90\u8bf7\u6c42\u4e0d\u63d0\u4f9b\u51ed\u636e\uff08cookie\u3001HTTP \u8ba4\u8bc1\u548c\u5ba2\u6237\u7aef SSL \u8bc1\u4e66\uff09\u3002\u53ef\u4ee5\u901a\u8fc7\u5c06 withCredentials \u5c5e\u6027\u8bbe\u7f6e\u4e3a true \u6765\u8868\u660e\u8bf7\u6c42\u4f1a\u53d1\u9001\u51ed\u636e\u3002\u5982\u679c\u670d\u52a1\u5668\u5141\u8bb8\u5e26\u51ed\u636e\u7684\u8bf7\u6c42, \u90a3\u4e48\u53ef\u4ee5\u5728\u54cd\u5e94\u4e2d\u5305\u542b\u5982\u4e0b HTTP \u5934\u90e8\uff1a"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Access-Control-Allow-Credentials: true")),(0,l.kt)("p",null,"\u670d\u52a1\u5668\u4e5f\u53ef\u4ee5\u5728\u9884\u68c0\u8bf7\u6c42\u7684\u54cd\u5e94\u4e2d\u53d1\u9001\u8fd9\u4e2a HTTP \u5934\u90e8, \u4ee5\u8868\u660e\u8fd9\u4e2a\u6e90\u5141\u8bb8\u53d1\u9001\u51ed\u636e\u8bf7\u6c42\u3002"),(0,l.kt)("h3",{id:"\u66ff\u4ee3\u6027\u8de8\u6e90\u6280\u672f"},"\u66ff\u4ee3\u6027\u8de8\u6e90\u6280\u672f"),(0,l.kt)("p",null,"CORS \u51fa\u73b0\u4e4b\u524d\u7684\u4e00\u4e9b\u8de8\u57df\u89e3\u51b3\u65b9\u6848, \u4e0d\u9700\u8981\u4fee\u6539\u670d\u52a1\u5668"),(0,l.kt)("h4",{id:"\u56fe\u7247\u63a2\u6d4b"},"\u56fe\u7247\u63a2\u6d4b"),(0,l.kt)("p",null,"\u4efb\u4f55\u9875\u9762\u90fd\u53ef\u4ee5\u8de8\u57df\u52a0\u8f7d\u56fe\u7247\u800c\u4e0d\u5fc5\u62c5\u5fc3\u9650\u5236, \u56e0\u6b64\u8fd9\u4e5f\u662f\u5728\u7ebf\u5e7f\u544a\u8ddf\u8e2a\u7684\u4e3b\u8981\u65b9\u5f0f"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"let img = new Image()\nimg.onload = img.onerror = function () {\n  alert('Done! ')\n}\nimg.src = 'http://www.example.com/test?name=Nicholas'\n")),(0,l.kt)("p",null,"\u56fe\u7247\u63a2\u6d4b\u7684\u7f3a\u70b9\u662f\u53ea\u80fd\u53d1\u9001 GET \u8bf7\u6c42\u548c\u65e0\u6cd5\u83b7\u53d6\u670d\u52a1\u5668\u54cd\u5e94\u7684\u5185\u5bb9"),(0,l.kt)("h4",{id:"jsonp-json-with-padding"},"JSONP (JSON with padding)"),(0,l.kt)("p",null,"JSONP \u683c\u5f0f\u5305\u542b\u4e24\u4e2a\u90e8\u5206\uff1a\u56de\u8c03\u548c\u6570\u636e"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"http://freegeoip.net/json/?callback=handleResponse")),(0,l.kt)("p",null,"JSONP \u8c03\u7528\u662f\u901a\u8fc7\u52a8\u6001\u521b\u5efa",(0,l.kt)("inlineCode",{parentName:"p"},"<script>"),"\u5143\u7d20\u5e76\u4e3a src \u5c5e\u6027\u6307\u5b9a\u8de8\u57df URL \u5b9e\u73b0\u7684\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"// \u670d\u52a1\u5668\u4f20\u8fc7\u6765\u7684\u6570\u636e\n// handleResponse({\"key\": \"value\"})\nfunction handleResponse(response) {\n  console.log(`\n    You're at IP address ${response.ip}, which is in\n    ${response.city}, ${response.region_name}`)\n}\nlet script = document.createElement('script')\nscript.src = 'http://freegeoip.net/json/?callback=handleResponse'\ndocument.body.insertBefore(script, document.body.firstChild)\n")),(0,l.kt)("h3",{id:"fetch-api"},"Fetch API"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"fetch('url', {\n  // \u914d\u7f6e\u53c2\u6570\n  // \u5982\u4e0b\n  method: 'POST',\n  body: JSON.stringify({ foo: 'bar' }),\n  // \u914d\u91cd\u8bf7\u6c42\u5934\n  headers: {\n    'Context-Type': 'application/json',\n  },\n})\n  .then(\n    (response) => {\n      response.status // \u72b6\u6001\u7801\n      response.statusText\n      response.redirected // \u662f\u5426\u91cd\u5b9a\u5411\n      response.ok\n      response.url // \u68c0\u67e5\u901a\u8fc7fetch()\u53d1\u9001\u8bf7\u6c42\u65f6\u4f7f\u7528\u7684\u5b8c\u6574URL\n      // \u5982 location.href \u4e3a https://foo.com/bar/baz\n      // url = 'qux' url =  https://foo.com/bar/baz/qux\n      // url = '/qux' url =  https://foo.com/qux\n      // url = '//qux.com' url =  https://qux.com\n      response.blob() // \u8f6c\u5316\u6210 Blob \u7c7b\u578b\n    },\n    (err) => {}\n  )\n  .then((blob) => {\n    image.src = URL.createObjectURL(blob)\n  })\n\n// \u7ec8\u6b62\u793a\u4f8b\nlet abortController = new AbortController()\nfetch('wikipedia.zip', { signal: abortController.signal }).catch(() =>\n  console.log('aborted!')\n)\nsetTimeout(() => abortController.abort(), 10)\n")),(0,l.kt)("h4",{id:"headers"},"Headers"),(0,l.kt)("p",null,"Headers \u4e0e Map \u7c7b\u578b\u90fd\u6709 get()\u3001set()\u3001has()\u548c delete()\u7b49\u5b9e\u4f8b\u65b9\u6cd5"),(0,l.kt)("p",null,"\u5728\u521d\u59cb\u5316 Headers \u5bf9\u8c61\u65f6, \u4e5f\u53ef\u4ee5\u4f7f\u7528\u952e/\u503c\u5bf9\u5f62\u5f0f\u7684\u5bf9\u8c61 ",(0,l.kt)("inlineCode",{parentName:"p"},'{a:"b"}'),", \u800c Map \u5219\u4e0d\u53ef\u4ee5"),(0,l.kt)("p",null,"Headers \u5bf9\u8c61\u901a\u8fc7 append('a', 'b') \u65b9\u6cd5\u652f\u6301\u6dfb\u52a0\u591a\u4e2a\u503c\u3002"),(0,l.kt)("h4",{id:"request"},"Request"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"let r1 = new Request('url', {\n  // ...\n})\nlet r2 = r1.clone()\n")),(0,l.kt)("h4",{id:"response"},"Response"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"let r1 = new Response('body', {\n  // ...\n})\nlet r2 = r1.clone()\n")),(0,l.kt)("h4",{id:"requestresponse-\u53ca-body-\u6df7\u5165"},"Request\u3001Response \u53ca Body \u6df7\u5165"),(0,l.kt)("p",null,"// todo"),(0,l.kt)("h3",{id:"beacon-api"},"Beacon API"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"// \u53d1\u9001POST\u8bf7\u6c42\n// URL: 'https://example.com/analytics-reporting-url'\n// \u8bf7\u6c42\u8d1f\u8f7d\uff1a'{foo: \"bar\"}'\nnavigator.sendBeacon(\n  'https://example.com/analytics-reporting-url',\n  '{foo: \"bar\"}'\n)\n\n// \u6d4f\u89c8\u5668\u4fdd\u8bc1\u5728\u539f\u59cb\u9875\u9762\u5df2\u7ecf\u5173\u95ed\u7684\u60c5\u51b5\u4e0b\u4e5f\u4f1a\u53d1\u9001\u8bf7\u6c42\n")),(0,l.kt)("h3",{id:"web-socket"},"Web Socket"),(0,l.kt)("p",null,"WebSocket \u7684\u76ee\u6807\u662f\u901a\u8fc7\u4e00\u4e2a",(0,l.kt)("strong",{parentName:"p"},"\u957f\u65f6\u8fde\u63a5"),"\u5b9e\u73b0\u4e0e\u670d\u52a1\u5668",(0,l.kt)("strong",{parentName:"p"},"\u5168\u53cc\u5de5\u3001\u53cc\u5411"),"\u7684\u901a\u4fe1\u3002\u5728 JavaScript \u4e2d\u521b\u5efa Web Socket \u65f6, \u4e00\u4e2a HTTP \u8bf7\u6c42\u4f1a\u53d1\u9001\u5230\u670d\u52a1\u5668\u4ee5\u521d\u59cb\u5316\u8fde\u63a5\u3002\u670d\u52a1\u5668\u54cd\u5e94\u540e, \u8fde\u63a5\u4f7f\u7528 HTTP \u7684 Upgrade \u5934\u90e8\u4ece HTTP \u534f\u8bae\u5207\u6362\u5230 Web Socket \u534f\u8bae\u3002\u4e0d\u80fd\u518d\u4f7f\u7528 http:// \u6216 https://, \u800c\u8981\u4f7f\u7528 ws:// \u548c wss://"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},'let socket = new WebSocket("ws://...")')),(0,l.kt)("p",null,"\u540c\u6e90\u7b56\u7565\u4e0d\u9002\u7528\u4e8e Web Socket, \u56e0\u6b64\u53ef\u4ee5\u6253\u5f00\u5230\u4efb\u610f\u7ad9\u70b9\u7684\u8fde\u63a5"),(0,l.kt)("p",null,"WebSocket \u6709\u4e00\u4e2a readyState \u5c5e\u6027\u8868\u793a\u5f53\u524d\u72b6\u6001\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"WebSocket.OPENING\uff080\uff09\uff1a\u8fde\u63a5\u6b63\u5728\u5efa\u7acb\u3002"),(0,l.kt)("li",{parentName:"ul"},"WebSocket.OPEN\uff081\uff09\uff1a\u8fde\u63a5\u5df2\u7ecf\u5efa\u7acb\u3002"),(0,l.kt)("li",{parentName:"ul"},"WebSocket.CLOSING\uff082\uff09\uff1a\u8fde\u63a5\u6b63\u5728\u5173\u95ed\u3002"),(0,l.kt)("li",{parentName:"ul"},"WebSocket.CLOSE\uff083\uff09\uff1a\u8fde\u63a5\u5df2\u7ecf\u5173\u95ed\u3002")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"socket.close()")),(0,l.kt)("h4",{id:"\u53d1\u9001\u548c\u63a5\u53d7\u6570\u636e"},"\u53d1\u9001\u548c\u63a5\u53d7\u6570\u636e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"socket.send(string | arrayBuffer[Unit8Array] | blob)\n\nsocket.onmessage = function (event) {\n  let data = event.data\n  // ...\n}\n")),(0,l.kt)("p",null,"\u5176\u4ed6\u4e8b\u4ef6"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"open: \u5728\u8fde\u63a5\u6210\u529f\u5efa\u7acb\u65f6\u89e6\u53d1"),(0,l.kt)("li",{parentName:"ul"},"error: \u5728\u53d1\u751f\u9519\u8bef\u65f6\u89e6\u53d1, \u8fde\u63a5\u65e0\u6cd5\u5b58\u7eed"),(0,l.kt)("li",{parentName:"ul"},"close: \u5728\u8fde\u63a5\u5173\u95ed\u65f6\u89e6\u53d1")),(0,l.kt)("h2",{id:"\u5ba2\u6237\u7aef\u5b58\u50a8"},"\u5ba2\u6237\u7aef\u5b58\u50a8"),(0,l.kt)("h3",{id:"cookie"},"Cookie"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"name=JohnDoe; expires=Thu, 21 Aug 2023 12:00:00 UTC; path=/; domain=example.com; secure; HttpOnly\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},'Name: \u7528\u6765\u6807\u8bc6 Cookie \u7684\u540d\u79f0, \u8fd9\u91cc\u662f "name"'),(0,l.kt)("li",{parentName:"ul"},'Value: \u8fd9\u91cc\u662f "JohnDoe"'),(0,l.kt)("li",{parentName:"ul"},"Domain: \u53ea\u6709\u5728\u6307\u5b9a\u57df\u4e0b\u7684\u9875\u9762\u624d\u80fd\u8bbf\u95ee\u8be5 Cookie\u3002"),(0,l.kt)("li",{parentName:"ul"},"Path: \u53ea\u6709\u5728\u6307\u5b9a\u8def\u5f84\u4e0b\u7684\u9875\u9762\u624d\u80fd\u8bbf\u95ee\u8be5 Cookie\u3002"),(0,l.kt)("li",{parentName:"ul"},"Expires: \u8868\u793a\u4f55\u65f6\u5220\u9664 Cookie \u7684\u65f6\u95f4\u6233"),(0,l.kt)("li",{parentName:"ul"},"Secure: \u8868\u793a\u8be5 Cookie \u53ea\u80fd\u5728\u5b89\u5168\u8fde\u63a5\u4e2d\uff08\u5373 HTTPS\uff09\u4f20\u8f93\u3002"),(0,l.kt)("li",{parentName:"ul"},"HttpOnly: \u8868\u793a\u8be5 Cookie \u65e0\u6cd5\u901a\u8fc7 JavaScript \u8bbf\u95ee, \u4ece\u800c\u589e\u52a0\u4e86\u5b89\u5168\u6027\u3002")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"document.cookie =\n  encodeURIComponent('name') + '=' + encodeURIComponent('Nicholas')\n")),(0,l.kt)("h4",{id:"\u5b50-cookie"},"\u5b50 Cookie"),(0,l.kt)("p",null,"\u5b50 Cookie \u4e3a\u7ed5\u8fc7\u6d4f\u89c8\u5668\u5bf9\u6bcf\u4e2a\u57df cookie \u6570\u7684\u9650\u5236\u3002\u5728\u5355\u4e2a cookie \u5b58\u50a8\u7684\u5c0f\u5757\u6570\u636e, \u8d28\u4e0a\u662f\u4f7f\u7528 cookie \u7684\u503c\u5728\u5355\u4e2a cookie \u4e2d\u5b58\u50a8\u591a\u4e2a\u540d/\u503c\u5bf9"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-txt"},"name=name1=value1&name2=value2&name3=value3&name4=value4&name5=value5\n")),(0,l.kt)("h3",{id:"storage"},"Storage"),(0,l.kt)("p",null,"\u65b9\u6cd5"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"clear()")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"getItem(name)")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"key(index)")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"removeItem(name)")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"setItem(name, value)"))),(0,l.kt)("p",null,"sessionStorage \u5bf9\u8c61\u53ea\u5b58\u50a8\u4f1a\u8bdd\u6570\u636e\uff0c\u8fd9\u610f\u5473\u7740\u6570\u636e\u53ea\u4f1a\u5b58\u50a8\u5230\u6d4f\u89c8\u5668\u5173\u95ed\u3002"),(0,l.kt)("p",null,"localStorage \u4f5c\u4e3a\u5728\u5ba2\u6237\u7aef\u6301\u4e45\u5b58\u50a8\u6570\u636e\u7684\u673a\u5236\u3002\u8981\u8bbf\u95ee\u540c\u4e00\u4e2a localStorage \u5bf9\u8c61\uff0c\u9875\u9762\u5fc5\u987b\u6765\u81ea\u540c\u4e00\u4e2a\u57df\uff08\u5b50\u57df\u4e0d\u53ef\u4ee5\uff09\u3001\u5728\u76f8\u540c\u7684\u7aef\u53e3\u4e0a\u4f7f\u7528\u76f8\u540c\u7684\u534f\u8bae\u3002\u5b58\u50a8\u5728 localStorage \u4e2d\u7684\u6570\u636e\u4f1a\u4fdd\u7559\u5230\u901a\u8fc7 JavaScript \u5220\u9664\u6216\u8005\u7528\u6237\u6e05\u9664\u6d4f\u89c8\u5668\u7f13\u5b58\u3002"),(0,l.kt)("p",null,"Storage \u5bf9\u8c61\u6539\u53d8\u65f6, \u89e6\u53d1\u4e8b\u4ef6"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"window.addEventListener('storage', (event) => {\n  event.domain // \u5b58\u50a8\u53d8\u5316\u5bf9\u5e94\u7684\u57df\n  event.key // \u88ab\u8bbe\u7f6e\u6216\u5220\u9664\u7684\u952e\n  event.newValue\n  event.oldVale\n})\n")),(0,l.kt)("h3",{id:"indexeddb"},"IndexedDB"),(0,l.kt)("p",null,"// todo"),(0,l.kt)("h2",{id:"\u6a21\u5757"},"\u6a21\u5757"),(0,l.kt)("h3",{id:"\u5f02\u6b65\u4f9d\u8d56"},"\u5f02\u6b65\u4f9d\u8d56"),(0,l.kt)("p",null,"\u53ef\u4ee5\u8ba9 JavaScript \u901a\u77e5\u6a21\u5757\u7cfb\u7edf\u5728\u5fc5\u8981\u65f6\u52a0\u8f7d\u65b0\u6a21\u5757\uff0c\u5e76\u5728\u6a21\u5757\u52a0\u8f7d\u5b8c\u6210\u540e\u63d0\u4f9b\u56de\u8c03"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"load('moduleB').then(function (moduleB) {\n  moduleB.doStuff()\n})\n")),(0,l.kt)("h3",{id:"\u52a8\u6001\u4f9d\u8d56"},"\u52a8\u6001\u4f9d\u8d56"),(0,l.kt)("p",null,"\u52a8\u6001\u4f9d\u8d56\u53ef\u4ee5\u652f\u6301\u66f4\u590d\u6742\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u4f46\u4ee3\u4ef7\u662f\u589e\u52a0\u4e86\u5bf9\u6a21\u5757\u8fdb\u884c\u9759\u6001\u5206\u6790\u7684\u96be\u5ea6"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"if (loadCondition) {\n  require('./moduleA')\n}\n")),(0,l.kt)("h3",{id:"\u9759\u6001\u5206\u6790"},"\u9759\u6001\u5206\u6790"),(0,l.kt)("p",null,"\u5206\u6790\u5de5\u5177\u4f1a\u68c0\u67e5\u4ee3\u7801\u7ed3\u6784\u5e76\u5728\u4e0d\u5b9e\u9645\u6267\u884c\u4ee3\u7801\u7684\u60c5\u51b5\u4e0b\u63a8\u65ad\u5176\u884c\u4e3a"),(0,l.kt)("h3",{id:"\u5faa\u73af\u4f9d\u8d56"},"\u5faa\u73af\u4f9d\u8d56"),(0,l.kt)("mermaid",{value:'graph TB\n\n\nA("module A \\n\\n require(D) \\n require(B)")\nB("module B \\n\\n require(A) \\n require(C)")\nC("module C \\n\\n require(B) \\n require(D)")\nD("module D \\n\\n require(C) \\n require(A)")\n\nE[cached A]\nF[cached B]\nG[cached C]\nH[cached D]\n\nA--\x3eD--\x3eC--\x3eB\nA--\x3eF\nD--\x3eE\nC--\x3eH\nB--\x3eE\nB--\x3eG'}),(0,l.kt)("h3",{id:"commonjs"},"CommonJS"),(0,l.kt)("p",null,"CommonJS \u6a21\u5757\u8bed\u6cd5\u4e0d\u80fd\u5728\u6d4f\u89c8\u5668\u4e2d\u76f4\u63a5\u8fd0\u884c"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"<script src='url'><\/script>")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"// moduleB\nvar moduleA = require('./moduleA')\n// \u5bfc\u51fa\nmodule.exports = {\n  stuff: moduleA.doStuff,\n}\n\nmodule.exports = {\n  a: 'A',\n  b: 'B',\n}\n// \u7b49\u4ef7\u64cd\u4f5c\uff1a\nmodule.exports.a = 'A'\nmodule.exports.b = 'B'\n\n// \u4f5c\u4e3a\u7c7b\u5bfc\u51fa\nclass A {}\nmodule.exports = A\nvar A = require('./moduleA')\nvar a = new A()\n\n// \u4f5c\u4e3a\u5b9e\u4f8b\u5bfc\u51fa\nclass A {}\nmodule.exports = new A()\n")),(0,l.kt)("p",null,"\u5f02\u6b65\u6a21\u5757\u5b9a\u4e49 Asynchronous Module Definition"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"define('moduleA', ['moduleB'], function (moduleB) {\n  return {\n    stuff: moduleB.doStuff(),\n  }\n})\n\ndefine('moduleA', ['require', 'exports'], function (require, exports) {\n  var moduleB = require('moduleB')\n  exports.stuff = moduleB.doStuff()\n})\n\ndefine('moduleA', ['require'], function () {\n  if (condition) {\n    var moduleB = require('moduleB')\n  }\n})\n")),(0,l.kt)("h3",{id:"es6-\u6a21\u5757"},"ES6 \u6a21\u5757"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},'<script type="module" src="url"><\/script>')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"// named export\n// \u5141\u8bb8\u6a21\u5757\u5b9a\u4e49\u591a\u4e2a\u5bfc\u51fa\u9879\uff0c\u5e76\u4e14\u6bcf\u4e2a\u5bfc\u51fa\u9879\u90fd\u53ef\u4ee5\u88ab\u547d\u540d\nexport const foo = 'foo'\n\nlet foo = 'foo'\nexport foo\n\nexport { foo }\n\nexport { foo as bar } //\u6307\u5b9a\u522b\u540d\n\n// default export\n// \u4e00\u4e2a\u6a21\u5757\u53ea\u80fd\u6709\u4e00\u4e2a\u9ed8\u8ba4\u5bfc\u51fa\nconst foo = 'foo'\nexport default foo\n\n// \u7b49\u540c\u4e8eexport default foo;\nexport { foo as default }\n\nexport foo\n\n// module.js\nconst foo = 'foo', bar = 'bar', baz = 'baz'\nexport { foo, bar, baz }\nexport default foo\n// index.js\nimport * as Foo from './foo.js'\nimport { foo, bar, baz } from './foo.js'\nimport foo from './foo.js'\n\n// \u9ed8\u8ba4\u5bfc\u51fa {\u547d\u540d\u5bfc\u51fa}\nimport foo, { bar } from './moduleC'\n")),(0,l.kt)("h4",{id:"\u5de5\u4f5c\u8005\u6a21\u5757"},"\u5de5\u4f5c\u8005\u6a21\u5757"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"// \u7b2c\u4e8c\u4e2a\u53c2\u6570\u9ed8\u8ba4\u4e3a{ type: 'classic' }\nconst scriptWorker = new Worker('scriptWorker.js')\nconst moduleWorker = new Worker('moduleWorker.js', { type: 'module' })\n")),(0,l.kt)("h4",{id:"\u5411\u540e\u517c\u5bb9"},"\u5411\u540e\u517c\u5bb9"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- \u652f\u6301\u6a21\u5757\u7684\u6d4f\u89c8\u5668\u4f1a\u6267\u884c\u8fd9\u6bb5\u811a\u672c  --\x3e\n\x3c!-- \u4e0d\u652f\u6301\u6a21\u5757\u7684\u6d4f\u89c8\u5668\u4e0d\u4f1a\u6267\u884c\u8fd9\u6bb5\u811a\u672c --\x3e\n<script type="module" src="module.js"><\/script>\n\x3c!-- \u53cd\u4e4b --\x3e\n<script nomodule src="script.js"><\/script>\n')),(0,l.kt)("h2",{id:"\u5de5\u4f5c\u8005\u7ebf\u7a0b"},"\u5de5\u4f5c\u8005\u7ebf\u7a0b"),(0,l.kt)("p",null,"\u5141\u8bb8\u628a\u4e3b\u7ebf\u7a0b\u7684\u5de5\u4f5c\u8f6c\u5ac1\u7ed9\u72ec\u7acb\u7684\u5b9e\u4f53\uff0c\u800c\u4e0d\u4f1a\u6539\u53d8\u73b0\u6709\u7684\u5355\u7ebf\u7a0b\u6a21\u578b"),(0,l.kt)("p",null,"\u4f7f\u7528\u5de5\u4f5c\u8005\u7ebf\u7a0b\uff0c\u6d4f\u89c8\u5668\u53ef\u4ee5\u5728\u539f\u59cb\u9875\u9762\u73af\u5883\u4e4b\u5916\u518d\u5206\u914d\u4e00\u4e2a\u5b8c\u5168\u72ec\u7acb\u7684\u4e8c\u7ea7\u5b50\u73af\u5883\u3002\u8fd9\u4e2a\u5b50\u73af\u5883\u4e0d\u80fd\u4e0e\u4f9d\u8d56\u5355\u7ebf\u7a0b\u4ea4\u4e92\u7684 API\uff08\u5982 DOM\uff09\u4e92\u64cd\u4f5c\uff0c\u4f46\u53ef\u4ee5\u4e0e\u7236\u73af\u5883\u5e76\u884c\u6267\u884c\u4ee3\u7801\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u4e0e\u7ebf\u7a0b\u7684\u5f02\u540c")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5de5\u4f5c\u8005\u7ebf\u7a0b\u662f\u4ee5\u5b9e\u9645\u7ebf\u7a0b\u5b9e\u73b0\u7684"),(0,l.kt)("li",{parentName:"ul"},"\u5de5\u4f5c\u8005\u7ebf\u7a0b\u5e76\u884c\u6267\u884c"),(0,l.kt)("li",{parentName:"ul"},"\u5de5\u4f5c\u8005\u7ebf\u7a0b\u53ef\u4ee5\u5171\u4eab\u67d0\u4e9b\u5185\u5b58")),(0,l.kt)("hr",null),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5de5\u4f5c\u8005\u7ebf\u7a0b\u4e0d\u5171\u4eab\u5168\u90e8\u5185\u5b58"),(0,l.kt)("li",{parentName:"ul"},"\u5de5\u4f5c\u8005\u7ebf\u7a0b\u4e0d\u4e00\u5b9a\u5728\u540c\u4e00\u4e2a\u8fdb\u7a0b\u91cc"),(0,l.kt)("li",{parentName:"ul"},"\u521b\u5efa\u5de5\u4f5c\u8005\u7ebf\u7a0b\u5f00\u9500\u66f4\u5927")),(0,l.kt)("h3",{id:"workerglobalscope"},"WorkerGlobalScope"),(0,l.kt)("p",null,"\u5728\u5de5\u4f5c\u8005\u7ebf\u7a0b\u5185\u90e8\uff0c\u6ca1\u6709 window \u7684\u6982\u5ff5\u3002"),(0,l.kt)("p",null,"\u8fd9\u91cc\u7684\u5168\u5c40\u5bf9\u8c61\u662f ",(0,l.kt)("inlineCode",{parentName:"p"},"WorkerGlobalScope")," \u7684\u5b9e\u4f8b\uff0c\u901a\u8fc7 self \u5173\u952e\u5b57\u66b4\u9732\u51fa\u6765\u3002"),(0,l.kt)("p",null,"self \u4e0a\u53ef\u7528\u7684\u5c5e\u6027\u662f window \u5bf9\u8c61\u4e0a\u5c5e\u6027\u7684\u4e25\u683c\u5b50\u96c6\u3002\u5176\u4e2d\u6709\u4e9b\u5c5e\u6027\u4f1a\u8fd4\u56de\u7279\u5b9a\u4e8e\u5de5\u4f5c\u8005\u7ebf\u7a0b\u7684\u7248\u672c\u3002"),(0,l.kt)("h3",{id:"\u4e13\u7528\u5de5\u4f5c\u8005-web-worker"},"\u4e13\u7528\u5de5\u4f5c\u8005 Web Worker"),(0,l.kt)("p",null,"\u4e13\u7528\u5de5\u4f5c\u8005\u53ef\u4ee5\u4e0e\u7236\u9875\u9762\u4ea4\u6362\u4fe1\u606f\u3001\u53d1\u9001\u7f51\u7edc\u8bf7\u6c42\u3001\u6267\u884c\u6587\u4ef6\u8f93\u5165/\u8f93\u51fa\u3001\u8fdb\u884c\u5bc6\u96c6\u8ba1\u7b97\u3001\u5904\u7406\u5927\u91cf\u6570\u636e\uff0c\u4ee5\u53ca\u5b9e\u73b0\u5176\u4ed6\u4e0d\u9002\u5408\u5728\u9875\u9762\u6267\u884c\u7ebf\u7a0b\u91cc\u505a\u7684\u4efb\u52a1"),(0,l.kt)("p",null,"\u540e\u53f0\u811a\u672c\uff08background script\uff09"),(0,l.kt)("p",null,"\u5de5\u4f5c\u8005\u7ebf\u7a0b\u7684\u811a\u672c\u6587\u4ef6\u53ea\u80fd\u4ece\u4e0e\u7236\u9875\u9762\u76f8\u540c\u7684\u6e90\u52a0\u8f7d"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"// worker.js\n\nself.onmessage = function (event) {\n  const data = event.data\n  // const result = processData(data)\n  // ...\n  self.postMessage(result)\n}\n\n// main.js\nconst worker = new Worker('./worker.js')\n\nworker.onmessage = function (event) {\n  // ...\n}\n// \u5411\u5de5\u4f5c\u8005\u53d1\u9001\u5f02\u6b65\u6d88\u606f\nworker.postMessage('data to process')\n")),(0,l.kt)("p",null,"// todo"),(0,l.kt)("h3",{id:"\u5171\u4eab\u5de5\u4f5c\u8005"},"\u5171\u4eab\u5de5\u4f5c\u8005"),(0,l.kt)("p",null,"// todo"),(0,l.kt)("h3",{id:"\u670d\u52a1\u5de5\u4f5c\u8005"},"\u670d\u52a1\u5de5\u4f5c\u8005"),(0,l.kt)("p",null,"//todo"),(0,l.kt)("h2",{id:"tips"},"Tips"),(0,l.kt)("admonition",{title:"\u89e3\u8026\u5e94\u7528\u7a0b\u5e8f\u903b\u8f91/\u4e8b\u4ef6\u5904\u7406\u51fd\u6570:",type:"tip"},(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},"\u4e0d\u8981\u628a event \u5bf9\u8c61\u4f20\u7ed9\u5176\u4ed6\u65b9\u6cd5\uff0c\u800c\u662f\u53ea\u4f20\u9012 event \u5bf9\u8c61\u4e2d\u5fc5\u8981\u7684\u6570\u636e"),(0,l.kt)("li",{parentName:"ul"},"\u5e94\u7528\u7a0b\u5e8f\u4e2d\u6bcf\u4e2a\u53ef\u80fd\u7684\u64cd\u4f5c\u90fd\u5e94\u8be5\u65e0\u987b\u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u5c31\u53ef\u4ee5\u6267\u884c"),(0,l.kt)("li",{parentName:"ul"},"\u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u5e94\u8be5\u5904\u7406\u4e8b\u4ef6\uff0c\u800c\u628a\u540e\u7eed\u5904\u7406\u4ea4\u7ed9\u5e94\u7528\u7a0b\u5e8f\u903b\u8f91"))),(0,l.kt)("hr",null),(0,l.kt)("admonition",{title:"\u5c0a\u91cd\u5bf9\u8c61\u6240\u6709\u6743:",type:"tip"},(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},"\u521b\u5efa\u65b0\u81ea\u5b9a\u4e49\u7c7b\u578b\u7ee7\u627f\u672c\u6765\u60f3\u8981\u4fee\u6539\u7684\u7c7b\u578b\uff0c\u53ef\u4ee5\u7ed9\u81ea\u5b9a\u4e49\u7c7b\u578b\u6dfb\u52a0\u65b0\u529f\u80fd\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u521b\u5efa\u5305\u542b\u60f3\u8981\u529f\u80fd\u7684\u65b0\u5bf9\u8c61\uff0c\u901a\u8fc7\u5b83\u4e0e\u522b\u4eba\u7684\u5bf9\u8c61\u4ea4\u4e92"))),(0,l.kt)("hr",null),(0,l.kt)("admonition",{title:"\u4e0d\u8981\u6bd4\u8f83 null:",type:"tip"},(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u503c\u5e94\u8be5\u662f\u5f15\u7528\u7c7b\u578b\uff0c\u5219\u4f7f\u7528 instanceof \u64cd\u4f5c\u7b26\u68c0\u67e5\u5176\u6784\u9020\u51fd\u6570"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u503c\u5e94\u8be5\u662f\u539f\u59cb\u7c7b\u578b\uff0c\u5219\u4f7f\u7528 typeof \u68c0\u67e5\u5176\u7c7b\u578b"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u5e0c\u671b\u503c\u662f\u6709\u7279\u5b9a\u65b9\u6cd5\u540d\u7684\u5bf9\u8c61\uff0c\u5219\u4f7f\u7528 typeof \u64cd\u4f5c\u7b26\u786e\u4fdd\u5bf9\u8c61\u4e0a\u5b58\u5728\u7ed9\u5b9a\u540d\u5b57\u7684\u65b9\u6cd5"))),(0,l.kt)("hr",null),(0,l.kt)("admonition",{title:"\u4f7f\u7528\u5e38\u91cf:",type:"tip"},(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},"\u91cd\u590d\u51fa\u73b0\u7684\u503c, \u91cd\u590d\u51fa\u73b0\u7684\u503c, URL, \u4efb\u4f55\u53ef\u80fd\u53d8\u5316\u7684\u503c"))),(0,l.kt)("hr",null),(0,l.kt)("admonition",{title:"\u907f\u514d\u5168\u5c40\u67e5\u627e:",type:"tip"},(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},"\u53ea\u8981\u51fd\u6570\u4e2d\u6709\u5f15\u7528\u8d85\u8fc7\u4e24\u6b21\u7684\u5168\u5c40\u5bf9\u8c61\uff0c\u5c31\u5e94\u8be5\u628a\u8fd9\u4e2a\u5bf9\u8c61\u4fdd\u5b58\u4e3a\u4e00\u4e2a\u5c40\u90e8\u53d8\u91cf\u3002"))),(0,l.kt)("hr",null),(0,l.kt)("admonition",{title:"\u5b9e\u65f6\u66f4\u65b0\u6700\u5c0f\u5316:",type:"tip"},(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},"\u53ea\u8981\u8fd4\u56de HTMLCollection \u5bf9\u8c61\uff0c\u5c31\u5e94\u8be5\u5c3d\u91cf\u4e0d\u8bbf\u95ee\u5b83"))))}m.isMDXComponent=!0}}]);