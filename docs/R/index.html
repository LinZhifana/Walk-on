<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-R/R">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">R for data science | NeutronStar xx</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://linzhifana.github.io/Walk-on/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://linzhifana.github.io/Walk-on/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://linzhifana.github.io/Walk-on/docs/R/"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="R for data science | NeutronStar xx"><meta data-rh="true" name="description" content="R for data science读书笔记"><meta data-rh="true" property="og:description" content="R for data science读书笔记"><link data-rh="true" rel="icon" href="/Walk-on/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://linzhifana.github.io/Walk-on/docs/R/"><link data-rh="true" rel="alternate" href="https://linzhifana.github.io/Walk-on/docs/R/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://linzhifana.github.io/Walk-on/docs/R/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://J18AIY1U4O-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/Walk-on/blog/rss.xml" title="NeutronStar xx RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Walk-on/blog/atom.xml" title="NeutronStar xx Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="NeutronStar xx" href="/Walk-on/opensearch.xml"><link rel="stylesheet" href="/Walk-on/assets/css/styles.82f16dea.css">
<link rel="preload" href="/Walk-on/assets/js/runtime~main.535a9680.js" as="script">
<link rel="preload" href="/Walk-on/assets/js/main.1575af58.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Walk-on/"><b class="navbar__title text--truncate">NeutronStarrr</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Walk-on/docs/intro">Notes</a><a class="navbar__item navbar__link" href="/Walk-on/blog">Blog</a></div><div class="navbar__items navbar__items--right"><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div><a href="https://github.com/LinZhifana/Walk-on" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/Walk-on/"><b>NeutronStarrr</b></a><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Walk-on/docs/intro">intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/Walk-on/docs/category/r">R</a><button aria-label="打开/收起侧边栏菜单「R」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Walk-on/docs/R/">R for data science</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Walk-on/docs/category/javascript">JavaScript</a><button aria-label="打开/收起侧边栏菜单「JavaScript」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Walk-on/docs/category/react">React</a><button aria-label="打开/收起侧边栏菜单「React」" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/Walk-on/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/Walk-on/docs/category/r"><span itemprop="name">R</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">R for data science</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>R for data science</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="data-visualization">Data visualization<a href="#data-visualization" class="hash-link" aria-label="Data visualization的直接链接" title="Data visualization的直接链接">​</a></h2><p><code>ggplots2</code> implements the grammar of graphic</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="data-frame">data frame<a href="#data-frame" class="hash-link" aria-label="data frame的直接链接" title="data frame的直接链接">​</a></h3><ul><li><strong>variable</strong>: a quantity, quality, or property that you can measure</li><li><strong>value</strong>: the state of a variable when you measure it. The value of a variable may change from measurement to measurement.</li><li><strong>observation</strong>: a set of measurements made under similar conditions (you usually make all of the measurements in an observation at the same time and on the same object). An observation will contain several values, each associated with a different variable. We’ll sometimes refer to an observation as a <strong>data point</strong>.</li><li><strong>tabular data</strong>: is a set of values, each associated with a variable and an observation. Tabular data is <em>tidy</em> if each value is placed in its own “cell”, each variable in its own column, and each observation in its own row.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ggplot">ggplot<a href="#ggplot" class="hash-link" aria-label="ggplot的直接链接" title="ggplot的直接链接">​</a></h3><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># canvas</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ggplot(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  data = penguins, # 数据集</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # aesthetics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mapping = aes(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    x = flipper_length_mm,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    y = body_mass_g,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # scaling</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    color = species</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># geometrical object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># geom_bar()/geom_line()/geom_boxplot()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">geom_point()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># layers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># fit on a linear model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">geom_smooth(method = &quot;lm&quot;) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 标签</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">labs(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  title = &quot;Body mass and flipper length&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  subtitle = &quot;Dimensions for Adelie, Chinstrap, and Gentoo Penguins&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x = &quot;Flipper length (mm)&quot;, y = &quot;Body mass (g)&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  color = &quot;Species&quot;, shape = &quot;Species&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 色盲友好</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scale_color_colorblind()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>scaling</strong>: When a categorical variable is mapped to an aesthetic, ggplot2 will automatically assign a unique value of the aesthetic</p><p><strong>global level</strong>: 全局级别的美学映射是在<code>ggplot()</code>函数中定义的, 它们将被传递给绘图中的所有 <code>geom</code> 图层(几何图形层)</p><p><strong>local level</strong>: 局部级别的美学映射是在具体的 <code>geom</code> 函数中定义的, 它们仅适用于该 <code>geom</code> 图层</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="visualizing-distributions">Visualizing distributions<a href="#visualizing-distributions" class="hash-link" aria-label="Visualizing distributions的直接链接" title="Visualizing distributions的直接链接">​</a></h3><p><strong>categorical</strong>: a variable can only take one of a small set values.</p><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># fct_inorder()/fct_infreq()/fct_inseq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Reorder factor levels by first appearance, frequency, or numeric order</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ggplot(penguins, aes(x = fct_infeq(species)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">geom_bar()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>numerical</strong>/<strong>quantitative</strong>: a variable can take on a wide range of numerical values, and it&#x27;s sensible to add, substracy, or take averages with those values.</p><p><strong>numerical</strong> can be <strong>continuous</strong> or <strong>discrete</strong>.</p><hr><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ggplot(penguins, aes(x = body_mass_g)) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  geom_histogram(binwidth = 200)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ggplot(penguins, aes(x = body_mass_g)) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  geom_density()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>histogram</strong>: for distributions of continuous variables</p><p><strong>density plot</strong>: for distributions of numerical variables</p><p><code>geom_bar()</code> 的颜色:</p><ul><li>边框填充 <code>geom_bar(color = &quot;red&quot;)</code></li><li>内容填充 <code>geom_bar(fill = &quot;red&quot;)</code></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="visualizing-relationships">Visualizing relationships<a href="#visualizing-relationships" class="hash-link" aria-label="Visualizing relationships的直接链接" title="Visualizing relationships的直接链接">​</a></h3><p><strong>boxplot</strong>: for relationship between a numerical and a categorical variable</p><p>A <strong>boxplot</strong> is a type of visual shorthand for measures of position(percentiles, 百分位数) that describe a distribution</p><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ggplot(penguins, aes(x = species, y = body_mass_g)) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  geom_boxplot()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ggplot(penguins, aes(x = body_mass_g, color = species)) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  geom_density(linewidth = 0.75)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><strong>stacked bar plots</strong>: for relationship between two categorical variables.</p><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ggplot(penguins, aes(x = island, fill = species)) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  geom_bar()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 创建频率图</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ggplot(penguins, aes(x = island, fill = species)) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  geom_bar(position = &quot;fill&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><strong>scatterplots and smooth curves</strong>: for relationship between two numerical variables.</p><hr><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g)) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  geom_point(aes(color = species, shape = island))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g)) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  geom_point(aes(color = species, shape = species)) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 以 island 分开</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  facet_wrap(~island)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="save">Save<a href="#save" class="hash-link" aria-label="Save的直接链接" title="Save的直接链接">​</a></h3><p><code>ggsave(filename = &quot;filename.png&quot;)</code></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="workflow">Workflow<a href="#workflow" class="hash-link" aria-label="Workflow的直接链接" title="Workflow的直接链接">​</a></h2><p>keyboard shortcut:</p><ul><li><code>&lt;-</code>: Alt + -</li><li>comment: Ctrl + Shift + C</li><li><code>%&gt;%</code>: Ctrl + Shift + M</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="data-transformation">Data transformation<a href="#data-transformation" class="hash-link" aria-label="Data transformation的直接链接" title="Data transformation的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="rows">Rows<a href="#rows" class="hash-link" aria-label="Rows的直接链接" title="Rows的直接链接">​</a></h3><p><strong><code>filter()</code></strong></p><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  filter(month == 1 &amp; day == 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  filter(month == 1 | month == 2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 或 等价于</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  filter(month %in% c(1, 2))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><strong><code>arrange()</code></strong></p><p>changes the order of rows based on the value of the columns.</p><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  arrange(year, month, day)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  arrange(des(dep_delay))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><strong><code>distinct()</code></strong></p><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># remove duplicate rows, if any</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  distinct()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># find all unique origin and destination pairs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  distinct(origin, dest)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># keep other columns when filtering for unique rows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  distinct(origin, dest, .keep_all = TRUE)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><strong>.</strong> 开头的变量代表是函数自带的变量, 不是列名</p></blockquote><hr><p><strong><code>count()</code></strong></p><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  count(origin, dest, sort = TRUE)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="columns">Columns<a href="#columns" class="hash-link" aria-label="Columns的直接链接" title="Columns的直接链接">​</a></h3><p><strong><code>mutate()</code></strong></p><p>create new columns that are derived from the existing columns</p><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mutate(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gain = dep_delay - arr_delay,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    speed = distance / air_time * 60</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 插在第一列</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mutate(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gain = dep_delay - arr_delay,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    speed = distance / air_time * 60,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .before = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 插在 day 列之后</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mutate(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gain = dep_delay - arr_delay,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    speed = distance / air_time * 60,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .after = day</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 保留被使用过的列</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mutate(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gain = dep_delay - arr_delay,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hours = air_time / 60,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gain_per_hour = gain / hours,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .keep = &quot;used&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><strong><code>select()</code></strong></p><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># select columns by name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  select(year, month, day)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># select all columns between year and day(inclusive)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  select(year:day)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># select all columns except those from year to day(inclusive)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  select(!year:day) # -(year:day) 等价于 !(year:day)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># select all columns that are characters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  select(where(is.character))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There are a number of helper functions you can use within <code>select()</code>:</p><ul><li><code>starts_with(&quot;abc&quot;)</code>: matches names that begin with “abc”.</li><li><code>ends_with(&quot;xyz&quot;)</code>: matches names that end with “xyz”.</li><li><code>contains(&quot;ijk&quot;)</code>: matches names that contain “ijk”.</li><li><code>num_range(&quot;x&quot;, 1:3)</code>: matches x1, x2 and x3.</li><li><code>match(&quot;[pt]al&quot;)</code>: matches names that contains &quot;pal&quot; or &quot;tal&quot;</li></ul><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># rename</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 新名字 = 旧名字</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  select(tail_num = tailnum)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><strong><code>rename()</code></strong></p><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 等价上面 select</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  rename(tail_num = tailnum)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><strong><code>relocate()</code></strong></p><p>change the position of columns</p><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># by default, relocate() moves variables to the front</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  relocate(time_hour, air_time)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  relocate(year:dep_time, .after = time_hour)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  relocate(starts_with(&quot;arr&quot;), .before = dep_time)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-pipe">The pipe<a href="#the-pipe" class="hash-link" aria-label="The pipe的直接链接" title="The pipe的直接链接">​</a></h3><p><code>|&gt;</code> 是 <code>%&gt;%</code> 简化版</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="groups">Groups<a href="#groups" class="hash-link" aria-label="Groups的直接链接" title="Groups的直接链接">​</a></h3><p><strong><code>group_by()</code></strong></p><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  group_by(year, month)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><strong><code>summarize()</code></strong></p><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  group_by(month) |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  summarize(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    avg_delay = mean(dep_delay, na.rm = TRUE),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    n = n() # 返回每组行数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 直接使用 .by 进行分组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  summarize(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    delay = mean(dep_delay, na.rm = TRUE),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    n = n(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .by = c(origin, dest)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><strong><code>slice_</code></strong> functions</p><ul><li><code>df |&gt; slice_head(n = 1)</code> takes the first row from each group.</li><li><code>df |&gt; slice_tail(n = 1)</code> takes the last row in each group.</li><li><code>df |&gt; slice_min(x, n = 1)</code> takes the row with the smallest value of column x.</li><li><code>df |&gt; slice_max(x, n = 1)</code> takes the row with the largest value of column x.</li><li><code>df |&gt; slice_sample(n = 1)</code> takes one random row.</li></ul><p>可以改变 <code>n</code> 值选择更多的行, 也可以使用 <code>prop</code> 代替, 如 <code>prop = 0.1</code> 选出前 10% 的行</p><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  group_by(dest) |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  slice_max(arr_delay, n = 1) |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  relocate(dest)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>在使用<code>summarize()</code>函数对一个数据集进行汇总时, 如果数据集已经按照多个变量进行了分组, 那么默认情况下, 每次汇总操作都会撤销掉最后一层分组。换句话说, 每次汇总操作都会将数据集的分组层次减少一级。</p><p>举个例子, 假设有一个数据集按照地区和年份进行了分组, 然后我们对这个数据集进行求和操作。如果默认行为被保留, 那么在对数据集进行求和后, 结果将不再按照年份进行分组, 而只按照地区进行分组。这样就少了一层分组, 即“年份”这一层被撤销了。</p><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 解决方案</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">daily &lt;- flights |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  group_by(year, month, day)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">daily_flights &lt;- daily |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  summarize(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    n = n(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .groups = &quot;drop_last&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><strong><code>ungroup()</code></strong></p><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">daily |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ungroup()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="data-tidying">Data tidying<a href="#data-tidying" class="hash-link" aria-label="Data tidying的直接链接" title="Data tidying的直接链接">​</a></h2><blockquote><p>“Happy families are all alike; every unhappy family is unhappy in its own way.”
— Leo Tolstoy</p></blockquote><blockquote><p>“Tidy datasets are all alike, but every messy dataset is messy in its own way.”
— Hadley Wickham</p></blockquote><ul><li>Each variable is a column; each column is a variable.</li><li>Each observation is a row; each row is an observation.</li><li>Each value is a cell; each cell is a single value.</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/LinZhifana/Walk-on/docs/R/R.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/Walk-on/docs/category/r"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">R</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Walk-on/docs/category/javascript"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">JavaScript</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#data-visualization" class="table-of-contents__link toc-highlight">Data visualization</a><ul><li><a href="#data-frame" class="table-of-contents__link toc-highlight">data frame</a></li><li><a href="#ggplot" class="table-of-contents__link toc-highlight">ggplot</a></li><li><a href="#visualizing-distributions" class="table-of-contents__link toc-highlight">Visualizing distributions</a></li><li><a href="#visualizing-relationships" class="table-of-contents__link toc-highlight">Visualizing relationships</a></li><li><a href="#save" class="table-of-contents__link toc-highlight">Save</a></li></ul></li><li><a href="#workflow" class="table-of-contents__link toc-highlight">Workflow</a></li><li><a href="#data-transformation" class="table-of-contents__link toc-highlight">Data transformation</a><ul><li><a href="#rows" class="table-of-contents__link toc-highlight">Rows</a></li><li><a href="#columns" class="table-of-contents__link toc-highlight">Columns</a></li><li><a href="#the-pipe" class="table-of-contents__link toc-highlight">The pipe</a></li><li><a href="#groups" class="table-of-contents__link toc-highlight">Groups</a></li></ul></li><li><a href="#data-tidying" class="table-of-contents__link toc-highlight">Data tidying</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/Walk-on/assets/js/runtime~main.535a9680.js"></script>
<script src="/Walk-on/assets/js/main.1575af58.js"></script>
</body>
</html>